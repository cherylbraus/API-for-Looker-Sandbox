{"queryResponse": {
    "parent_id": "f00083de83cef49cabf2cda23f03acae",
    "sql_changed": true,
    "aggregate_table_used_info": null,
    "added_params": null,
    "cached_derived": true,
    "data": [
        {
            "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
                "value": "Below 0",
                "sort_value": "00"
            },
            "shipments.shipment_count": {
                "2023-05-08": {
                    "value": null
                },
                "2023-05-15": {
                    "value": null
                },
                "2023-05-22": {
                    "value": null
                },
                "2023-05-29": {
                    "value": null
                },
                "2023-06-05": {
                    "value": null
                }
            },
            "test_percent": {
                "2023-05-08": {
                    "value": null,
                    "rendered": "null"
                },
                "2023-05-15": {
                    "value": null,
                    "rendered": "null"
                },
                "2023-05-22": {
                    "value": null,
                    "rendered": "null"
                },
                "2023-05-29": {
                    "value": null,
                    "rendered": "null"
                },
                "2023-06-05": {
                    "value": null,
                    "rendered": "null"
                }
            }
        },
        {
            "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
                "value": "0 to 9",
                "sort_value": "01"
            },
            "shipments.shipment_count": {
                "2023-05-08": {
                    "value": null
                },
                "2023-05-15": {
                    "value": null
                },
                "2023-05-22": {
                    "value": null
                },
                "2023-05-29": {
                    "value": null
                },
                "2023-06-05": {
                    "value": null
                }
            },
            "test_percent": {
                "2023-05-08": {
                    "value": null,
                    "rendered": "null"
                },
                "2023-05-15": {
                    "value": null,
                    "rendered": "null"
                },
                "2023-05-22": {
                    "value": null,
                    "rendered": "null"
                },
                "2023-05-29": {
                    "value": null,
                    "rendered": "null"
                },
                "2023-06-05": {
                    "value": null,
                    "rendered": "null"
                }
            }
        },
        {
            "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
                "value": "10 to 19",
                "sort_value": "02"
            },
            "shipments.shipment_count": {
                "2023-05-08": {
                    "value": 792,
                    "links": [
                        {
                            "label": "Show All 792",
                            "label_prefix": "Show All",
                            "label_value": "792",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=10+to+19&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-15": {
                    "value": 417,
                    "links": [
                        {
                            "label": "Show All 417",
                            "label_prefix": "Show All",
                            "label_value": "417",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=10+to+19&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-22": {
                    "value": 742,
                    "links": [
                        {
                            "label": "Show All 742",
                            "label_prefix": "Show All",
                            "label_value": "742",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=10+to+19&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-29": {
                    "value": 814,
                    "links": [
                        {
                            "label": "Show All 814",
                            "label_prefix": "Show All",
                            "label_value": "814",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=10+to+19&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-06-05": {
                    "value": 441,
                    "links": [
                        {
                            "label": "Show All 441",
                            "label_prefix": "Show All",
                            "label_value": "441",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=10+to+19&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                }
            },
            "test_percent": {
                "2023-05-08": {
                    "value": 0.23259911894273128,
                    "rendered": "23%"
                },
                "2023-05-15": {
                    "value": 0.12311780336581045,
                    "rendered": "12%"
                },
                "2023-05-22": {
                    "value": 0.21334100057504313,
                    "rendered": "21%"
                },
                "2023-05-29": {
                    "value": 0.24969325153374233,
                    "rendered": "25%"
                },
                "2023-06-05": {
                    "value": 0.2791139240506329,
                    "rendered": "28%"
                }
            }
        },
        {
            "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
                "value": "20 to 29",
                "sort_value": "03"
            },
            "shipments.shipment_count": {
                "2023-05-08": {
                    "value": 510,
                    "links": [
                        {
                            "label": "Show All 510",
                            "label_prefix": "Show All",
                            "label_value": "510",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=20+to+29&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-15": {
                    "value": 280,
                    "links": [
                        {
                            "label": "Show All 280",
                            "label_prefix": "Show All",
                            "label_value": "280",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=20+to+29&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-22": {
                    "value": 420,
                    "links": [
                        {
                            "label": "Show All 420",
                            "label_prefix": "Show All",
                            "label_value": "420",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=20+to+29&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-29": {
                    "value": 464,
                    "links": [
                        {
                            "label": "Show All 464",
                            "label_prefix": "Show All",
                            "label_value": "464",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=20+to+29&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-06-05": {
                    "value": 249,
                    "links": [
                        {
                            "label": "Show All 249",
                            "label_prefix": "Show All",
                            "label_value": "249",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=20+to+29&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                }
            },
            "test_percent": {
                "2023-05-08": {
                    "value": 0.14977973568281938,
                    "rendered": "15%"
                },
                "2023-05-15": {
                    "value": 0.0826690286389135,
                    "rendered": "8%"
                },
                "2023-05-22": {
                    "value": 0.12075905692926969,
                    "rendered": "12%"
                },
                "2023-05-29": {
                    "value": 0.1423312883435583,
                    "rendered": "14%"
                },
                "2023-06-05": {
                    "value": 0.15759493670886077,
                    "rendered": "16%"
                }
            }
        },
        {
            "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
                "value": "30 to 39",
                "sort_value": "04"
            },
            "shipments.shipment_count": {
                "2023-05-08": {
                    "value": 231,
                    "links": [
                        {
                            "label": "Show All 231",
                            "label_prefix": "Show All",
                            "label_value": "231",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=30+to+39&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-15": {
                    "value": 267,
                    "links": [
                        {
                            "label": "Show All 267",
                            "label_prefix": "Show All",
                            "label_value": "267",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=30+to+39&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-22": {
                    "value": 218,
                    "links": [
                        {
                            "label": "Show All 218",
                            "label_prefix": "Show All",
                            "label_value": "218",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=30+to+39&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-29": {
                    "value": 280,
                    "links": [
                        {
                            "label": "Show All 280",
                            "label_prefix": "Show All",
                            "label_value": "280",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=30+to+39&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-06-05": {
                    "value": 72,
                    "links": [
                        {
                            "label": "Show All 72",
                            "label_prefix": "Show All",
                            "label_value": "72",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=30+to+39&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                }
            },
            "test_percent": {
                "2023-05-08": {
                    "value": 0.06784140969162995,
                    "rendered": "7%"
                },
                "2023-05-15": {
                    "value": 0.07883082373782108,
                    "rendered": "8%"
                },
                "2023-05-22": {
                    "value": 0.06267970097757332,
                    "rendered": "6%"
                },
                "2023-05-29": {
                    "value": 0.08588957055214724,
                    "rendered": "9%"
                },
                "2023-06-05": {
                    "value": 0.04556962025316456,
                    "rendered": "5%"
                }
            }
        },
        {
            "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
                "value": "40 to 49",
                "sort_value": "05"
            },
            "shipments.shipment_count": {
                "2023-05-08": {
                    "value": 237,
                    "links": [
                        {
                            "label": "Show All 237",
                            "label_prefix": "Show All",
                            "label_value": "237",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=40+to+49&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-15": {
                    "value": 194,
                    "links": [
                        {
                            "label": "Show All 194",
                            "label_prefix": "Show All",
                            "label_value": "194",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=40+to+49&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-22": {
                    "value": 195,
                    "links": [
                        {
                            "label": "Show All 195",
                            "label_prefix": "Show All",
                            "label_value": "195",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=40+to+49&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-29": {
                    "value": 210,
                    "links": [
                        {
                            "label": "Show All 210",
                            "label_prefix": "Show All",
                            "label_value": "210",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=40+to+49&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-06-05": {
                    "value": 97,
                    "links": [
                        {
                            "label": "Show All 97",
                            "label_prefix": "Show All",
                            "label_value": "97",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=40+to+49&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                }
            },
            "test_percent": {
                "2023-05-08": {
                    "value": 0.06960352422907488,
                    "rendered": "7%"
                },
                "2023-05-15": {
                    "value": 0.05727782698553292,
                    "rendered": "6%"
                },
                "2023-05-22": {
                    "value": 0.056066705002875215,
                    "rendered": "6%"
                },
                "2023-05-29": {
                    "value": 0.06441717791411043,
                    "rendered": "6%"
                },
                "2023-06-05": {
                    "value": 0.06139240506329114,
                    "rendered": "6%"
                }
            }
        },
        {
            "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
                "value": "50 to 59",
                "sort_value": "06"
            },
            "shipments.shipment_count": {
                "2023-05-08": {
                    "value": 237,
                    "links": [
                        {
                            "label": "Show All 237",
                            "label_prefix": "Show All",
                            "label_value": "237",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=50+to+59&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-15": {
                    "value": 204,
                    "links": [
                        {
                            "label": "Show All 204",
                            "label_prefix": "Show All",
                            "label_value": "204",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=50+to+59&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-22": {
                    "value": 234,
                    "links": [
                        {
                            "label": "Show All 234",
                            "label_prefix": "Show All",
                            "label_value": "234",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=50+to+59&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-29": {
                    "value": 268,
                    "links": [
                        {
                            "label": "Show All 268",
                            "label_prefix": "Show All",
                            "label_value": "268",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=50+to+59&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-06-05": {
                    "value": 135,
                    "links": [
                        {
                            "label": "Show All 135",
                            "label_prefix": "Show All",
                            "label_value": "135",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=50+to+59&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                }
            },
            "test_percent": {
                "2023-05-08": {
                    "value": 0.06960352422907488,
                    "rendered": "7%"
                },
                "2023-05-15": {
                    "value": 0.06023029229406555,
                    "rendered": "6%"
                },
                "2023-05-22": {
                    "value": 0.06728004600345026,
                    "rendered": "7%"
                },
                "2023-05-29": {
                    "value": 0.08220858895705521,
                    "rendered": "8%"
                },
                "2023-06-05": {
                    "value": 0.08544303797468354,
                    "rendered": "9%"
                }
            }
        },
        {
            "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
                "value": "60 to 69",
                "sort_value": "07"
            },
            "shipments.shipment_count": {
                "2023-05-08": {
                    "value": 258,
                    "links": [
                        {
                            "label": "Show All 258",
                            "label_prefix": "Show All",
                            "label_value": "258",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=60+to+69&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-15": {
                    "value": 244,
                    "links": [
                        {
                            "label": "Show All 244",
                            "label_prefix": "Show All",
                            "label_value": "244",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=60+to+69&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-22": {
                    "value": 240,
                    "links": [
                        {
                            "label": "Show All 240",
                            "label_prefix": "Show All",
                            "label_value": "240",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=60+to+69&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-29": {
                    "value": 181,
                    "links": [
                        {
                            "label": "Show All 181",
                            "label_prefix": "Show All",
                            "label_value": "181",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=60+to+69&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-06-05": {
                    "value": 138,
                    "links": [
                        {
                            "label": "Show All 138",
                            "label_prefix": "Show All",
                            "label_value": "138",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=60+to+69&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                }
            },
            "test_percent": {
                "2023-05-08": {
                    "value": 0.07577092511013216,
                    "rendered": "8%"
                },
                "2023-05-15": {
                    "value": 0.07204015352819604,
                    "rendered": "7%"
                },
                "2023-05-22": {
                    "value": 0.06900517538815411,
                    "rendered": "7%"
                },
                "2023-05-29": {
                    "value": 0.055521472392638035,
                    "rendered": "6%"
                },
                "2023-06-05": {
                    "value": 0.08734177215189873,
                    "rendered": "9%"
                }
            }
        },
        {
            "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
                "value": "70 to 79",
                "sort_value": "08"
            },
            "shipments.shipment_count": {
                "2023-05-08": {
                    "value": 339,
                    "links": [
                        {
                            "label": "Show All 339",
                            "label_prefix": "Show All",
                            "label_value": "339",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=70+to+79&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-15": {
                    "value": 330,
                    "links": [
                        {
                            "label": "Show All 330",
                            "label_prefix": "Show All",
                            "label_value": "330",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=70+to+79&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-22": {
                    "value": 365,
                    "links": [
                        {
                            "label": "Show All 365",
                            "label_prefix": "Show All",
                            "label_value": "365",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=70+to+79&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-29": {
                    "value": 299,
                    "links": [
                        {
                            "label": "Show All 299",
                            "label_prefix": "Show All",
                            "label_value": "299",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=70+to+79&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-06-05": {
                    "value": 133,
                    "links": [
                        {
                            "label": "Show All 133",
                            "label_prefix": "Show All",
                            "label_value": "133",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=70+to+79&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                }
            },
            "test_percent": {
                "2023-05-08": {
                    "value": 0.09955947136563877,
                    "rendered": "10%"
                },
                "2023-05-15": {
                    "value": 0.09743135518157661,
                    "rendered": "10%"
                },
                "2023-05-22": {
                    "value": 0.1049453709028177,
                    "rendered": "10%"
                },
                "2023-05-29": {
                    "value": 0.09171779141104294,
                    "rendered": "9%"
                },
                "2023-06-05": {
                    "value": 0.08417721518987342,
                    "rendered": "8%"
                }
            }
        },
        {
            "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
                "value": "80 to 89",
                "sort_value": "09"
            },
            "shipments.shipment_count": {
                "2023-05-08": {
                    "value": 285,
                    "links": [
                        {
                            "label": "Show All 285",
                            "label_prefix": "Show All",
                            "label_value": "285",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=80+to+89&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-15": {
                    "value": 366,
                    "links": [
                        {
                            "label": "Show All 366",
                            "label_prefix": "Show All",
                            "label_value": "366",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=80+to+89&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-22": {
                    "value": 334,
                    "links": [
                        {
                            "label": "Show All 334",
                            "label_prefix": "Show All",
                            "label_value": "334",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=80+to+89&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-29": {
                    "value": 233,
                    "links": [
                        {
                            "label": "Show All 233",
                            "label_prefix": "Show All",
                            "label_value": "233",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=80+to+89&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-06-05": {
                    "value": 129,
                    "links": [
                        {
                            "label": "Show All 129",
                            "label_prefix": "Show All",
                            "label_value": "129",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=80+to+89&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                }
            },
            "test_percent": {
                "2023-05-08": {
                    "value": 0.08370044052863436,
                    "rendered": "8%"
                },
                "2023-05-15": {
                    "value": 0.10806023029229407,
                    "rendered": "11%"
                },
                "2023-05-22": {
                    "value": 0.09603220241518114,
                    "rendered": "10%"
                },
                "2023-05-29": {
                    "value": 0.07147239263803681,
                    "rendered": "7%"
                },
                "2023-06-05": {
                    "value": 0.08164556962025317,
                    "rendered": "8%"
                }
            }
        },
        {
            "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
                "value": "90 to 99",
                "sort_value": "10"
            },
            "shipments.shipment_count": {
                "2023-05-08": {
                    "value": 516,
                    "links": [
                        {
                            "label": "Show All 516",
                            "label_prefix": "Show All",
                            "label_value": "516",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=90+to+99&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-15": {
                    "value": 1085,
                    "rendered": "1,085",
                    "links": [
                        {
                            "label": "Show All 1,085",
                            "label_prefix": "Show All",
                            "label_value": "1,085",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=90+to+99&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-22": {
                    "value": 730,
                    "links": [
                        {
                            "label": "Show All 730",
                            "label_prefix": "Show All",
                            "label_value": "730",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=90+to+99&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-05-29": {
                    "value": 511,
                    "links": [
                        {
                            "label": "Show All 511",
                            "label_prefix": "Show All",
                            "label_value": "511",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=90+to+99&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "2023-06-05": {
                    "value": 186,
                    "links": [
                        {
                            "label": "Show All 186",
                            "label_prefix": "Show All",
                            "label_value": "186",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=90+to+99&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                }
            },
            "test_percent": {
                "2023-05-08": {
                    "value": 0.1515418502202643,
                    "rendered": "15%"
                },
                "2023-05-15": {
                    "value": 0.3203424859757898,
                    "rendered": "32%"
                },
                "2023-05-22": {
                    "value": 0.2098907418056354,
                    "rendered": "21%"
                },
                "2023-05-29": {
                    "value": 0.15674846625766872,
                    "rendered": "16%"
                },
                "2023-06-05": {
                    "value": 0.11772151898734177,
                    "rendered": "12%"
                }
            }
        },
        {
            "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
                "value": "100 or Above",
                "sort_value": "11"
            },
            "shipments.shipment_count": {
                "2023-05-08": {
                    "value": null
                },
                "2023-05-15": {
                    "value": null
                },
                "2023-05-22": {
                    "value": null
                },
                "2023-05-29": {
                    "value": null
                },
                "2023-06-05": {
                    "value": null
                }
            },
            "test_percent": {
                "2023-05-08": {
                    "value": null,
                    "rendered": "null"
                },
                "2023-05-15": {
                    "value": null,
                    "rendered": "null"
                },
                "2023-05-22": {
                    "value": null,
                    "rendered": "null"
                },
                "2023-05-29": {
                    "value": null,
                    "rendered": "null"
                },
                "2023-06-05": {
                    "value": null,
                    "rendered": "null"
                }
            }
        }
    ],
    "drill_menu_build_time": 0.045551,
    "expired": false,
    "fields": {
        "measures": [],
        "dimensions": [
            {
                "align": "left",
                "can_filter": true,
                "category": "dimension",
                "default_filter_value": null,
                "description": "",
                "enumerations": [
                    {
                        "label": "Below 0",
                        "value": "Below 0"
                    },
                    {
                        "label": "0 to 9",
                        "value": "0 to 9"
                    },
                    {
                        "label": "10 to 19",
                        "value": "10 to 19"
                    },
                    {
                        "label": "20 to 29",
                        "value": "20 to 29"
                    },
                    {
                        "label": "30 to 39",
                        "value": "30 to 39"
                    },
                    {
                        "label": "40 to 49",
                        "value": "40 to 49"
                    },
                    {
                        "label": "50 to 59",
                        "value": "50 to 59"
                    },
                    {
                        "label": "60 to 69",
                        "value": "60 to 69"
                    },
                    {
                        "label": "70 to 79",
                        "value": "70 to 79"
                    },
                    {
                        "label": "80 to 89",
                        "value": "80 to 89"
                    },
                    {
                        "label": "90 to 99",
                        "value": "90 to 99"
                    },
                    {
                        "label": "100 or Above",
                        "value": "100 or Above"
                    },
                    {
                        "label": "Undefined",
                        "value": "Undefined"
                    }
                ],
                "field_group_label": "Rates as TCM Percentile",
                "fill_style": "enumeration",
                "fiscal_month_offset": 0,
                "has_allowed_values": false,
                "hidden": false,
                "is_filter": false,
                "is_numeric": false,
                "label": "Transfix Cost Predictions Carrier Rate As Tcm Percentile Tier",
                "label_from_parameter": null,
                "label_short": "Carrier Rate As Tcm Percentile Tier",
                "map_layer": null,
                "name": "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier",
                "strict_value_format": false,
                "requires_refresh_on_sort": false,
                "sortable": true,
                "suggestions": [
                    "Below 0",
                    "0 to 9",
                    "10 to 19",
                    "20 to 29",
                    "30 to 39",
                    "40 to 49",
                    "50 to 59",
                    "60 to 69",
                    "70 to 79",
                    "80 to 89",
                    "90 to 99",
                    "100 or Above",
                    "Undefined"
                ],
                "tags": [],
                "type": "tier",
                "user_attribute_filter_types": [
                    "string",
                    "advanced_filter_string"
                ],
                "value_format": null,
                "view": "shipment_transfix_cost_predictions",
                "view_label": "Transfix Cost Predictions",
                "dynamic": false,
                "week_start_day": "monday",
                "original_view": "shipment_transfix_cost_predictions",
                "dimension_group": null,
                "error": null,
                "field_group_variant": "Carrier Rate As Tcm Percentile Tier",
                "measure": false,
                "parameter": false,
                "primary_key": false,
                "project_name": "snowflake",
                "scope": "shipment_transfix_cost_predictions",
                "suggest_dimension": "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier",
                "suggest_explore": "shipments",
                "suggestable": true,
                "is_fiscal": false,
                "is_timeframe": false,
                "can_time_filter": false,
                "time_interval": null,
                "lookml_link": "/projects/snowflake/files/MarketPlace%2FCore%2Fviews%2Fshipment_transfix_cost_predictions.view.lkml?line=298",
                "permanent": null,
                "source_file": "MarketPlace/Core/views/shipment_transfix_cost_predictions.view.lkml",
                "source_file_path": "snowflake/MarketPlace/Core/views/shipment_transfix_cost_predictions.view.lkml",
                "sql": "round(${carrier_rate_as_tcm_percentile},0) ",
                "sql_case": null,
                "filters": null,
                "times_used": 0,
                "sorted": {
                    "desc": false,
                    "sort_index": 0
                }
            }
        ],
        "table_calculations": [
            {
                "label": "test_percent",
                "name": "test_percent",
                "expression": "${shipments.shipment_count} / sum(${shipments.shipment_count})",
                "can_pivot": true,
                "sortable": true,
                "type": "number",
                "align": "right",
                "measure": true,
                "is_table_calculation": true,
                "dynamic": true,
                "value_format": "#,##0%",
                "is_numeric": true
            }
        ],
        "pivots": [
            {
                "align": "left",
                "can_filter": true,
                "category": "dimension",
                "default_filter_value": null,
                "description": "The time that the current carrier assignment was created",
                "enumerations": null,
                "field_group_label": "Timestamps",
                "fill_style": "range",
                "fiscal_month_offset": 0,
                "has_allowed_values": false,
                "hidden": false,
                "is_filter": false,
                "is_numeric": false,
                "label": "Shipments Assigned Week",
                "label_from_parameter": null,
                "label_short": "Assigned Week",
                "map_layer": null,
                "name": "shipments.assigned_week",
                "strict_value_format": false,
                "requires_refresh_on_sort": false,
                "sortable": true,
                "suggestions": null,
                "tags": [],
                "type": "date_week",
                "user_attribute_filter_types": [
                    "datetime",
                    "advanced_filter_datetime"
                ],
                "value_format": null,
                "view": "shipments",
                "view_label": "Shipments",
                "dynamic": false,
                "week_start_day": "monday",
                "original_view": "shipments",
                "dimension_group": "shipments.assigned",
                "error": null,
                "field_group_variant": "Assigned Week",
                "measure": false,
                "parameter": false,
                "primary_key": false,
                "project_name": "snowflake",
                "scope": "shipments",
                "suggest_dimension": "shipments.assigned_week",
                "suggest_explore": "shipments",
                "suggestable": false,
                "is_fiscal": false,
                "is_timeframe": true,
                "can_time_filter": false,
                "time_interval": {
                    "name": "week",
                    "count": 1
                },
                "lookml_link": "/projects/snowflake/files/MarketPlace%2FCore%2Fviews%2Fshipments.view.lkml?line=834",
                "permanent": null,
                "source_file": "MarketPlace/Core/views/shipments.view.lkml",
                "source_file_path": "snowflake/MarketPlace/Core/views/shipments.view.lkml",
                "sql": "${shipment_current_assignment.created_time}::timestamp_ntz ",
                "sql_case": null,
                "filters": null,
                "times_used": 0,
                "sorted": {
                    "desc": false,
                    "sort_index": 1
                }
            }
        ],
        "measure_like": [
            {
                "label": "test_percent",
                "name": "test_percent",
                "expression": "${shipments.shipment_count} / sum(${shipments.shipment_count})",
                "can_pivot": true,
                "sortable": true,
                "type": "number",
                "align": "right",
                "measure": true,
                "is_table_calculation": true,
                "dynamic": true,
                "value_format": "#,##0%",
                "is_numeric": true
            }
        ],
        "supermeasure_like": [],
        "dimension_like": [
            {
                "align": "left",
                "can_filter": true,
                "category": "dimension",
                "default_filter_value": null,
                "description": "",
                "enumerations": [
                    {
                        "label": "Below 0",
                        "value": "Below 0"
                    },
                    {
                        "label": "0 to 9",
                        "value": "0 to 9"
                    },
                    {
                        "label": "10 to 19",
                        "value": "10 to 19"
                    },
                    {
                        "label": "20 to 29",
                        "value": "20 to 29"
                    },
                    {
                        "label": "30 to 39",
                        "value": "30 to 39"
                    },
                    {
                        "label": "40 to 49",
                        "value": "40 to 49"
                    },
                    {
                        "label": "50 to 59",
                        "value": "50 to 59"
                    },
                    {
                        "label": "60 to 69",
                        "value": "60 to 69"
                    },
                    {
                        "label": "70 to 79",
                        "value": "70 to 79"
                    },
                    {
                        "label": "80 to 89",
                        "value": "80 to 89"
                    },
                    {
                        "label": "90 to 99",
                        "value": "90 to 99"
                    },
                    {
                        "label": "100 or Above",
                        "value": "100 or Above"
                    },
                    {
                        "label": "Undefined",
                        "value": "Undefined"
                    }
                ],
                "field_group_label": "Rates as TCM Percentile",
                "fill_style": "enumeration",
                "fiscal_month_offset": 0,
                "has_allowed_values": false,
                "hidden": false,
                "is_filter": false,
                "is_numeric": false,
                "label": "Transfix Cost Predictions Carrier Rate As Tcm Percentile Tier",
                "label_from_parameter": null,
                "label_short": "Carrier Rate As Tcm Percentile Tier",
                "map_layer": null,
                "name": "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier",
                "strict_value_format": false,
                "requires_refresh_on_sort": false,
                "sortable": true,
                "suggestions": [
                    "Below 0",
                    "0 to 9",
                    "10 to 19",
                    "20 to 29",
                    "30 to 39",
                    "40 to 49",
                    "50 to 59",
                    "60 to 69",
                    "70 to 79",
                    "80 to 89",
                    "90 to 99",
                    "100 or Above",
                    "Undefined"
                ],
                "tags": [],
                "type": "tier",
                "user_attribute_filter_types": [
                    "string",
                    "advanced_filter_string"
                ],
                "value_format": null,
                "view": "shipment_transfix_cost_predictions",
                "view_label": "Transfix Cost Predictions",
                "dynamic": false,
                "week_start_day": "monday",
                "original_view": "shipment_transfix_cost_predictions",
                "dimension_group": null,
                "error": null,
                "field_group_variant": "Carrier Rate As Tcm Percentile Tier",
                "measure": false,
                "parameter": false,
                "primary_key": false,
                "project_name": "snowflake",
                "scope": "shipment_transfix_cost_predictions",
                "suggest_dimension": "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier",
                "suggest_explore": "shipments",
                "suggestable": true,
                "is_fiscal": false,
                "is_timeframe": false,
                "can_time_filter": false,
                "time_interval": null,
                "lookml_link": "/projects/snowflake/files/MarketPlace%2FCore%2Fviews%2Fshipment_transfix_cost_predictions.view.lkml?line=298",
                "permanent": null,
                "source_file": "MarketPlace/Core/views/shipment_transfix_cost_predictions.view.lkml",
                "source_file_path": "snowflake/MarketPlace/Core/views/shipment_transfix_cost_predictions.view.lkml",
                "sql": "round(${carrier_rate_as_tcm_percentile},0) ",
                "sql_case": null,
                "filters": null,
                "times_used": 0,
                "sorted": {
                    "desc": false,
                    "sort_index": 0
                }
            }
        ]
    },
    "fill_fields": [
        "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier",
        "shipments.assigned_week"
    ],
    "forecast_result": null,
    "has_row_totals": false,
    "has_totals": false,
    "id": "query-result-7:{\"hidden_points_if_no\":[],\"hidden_fields\":[\"shipments.shipment_count\"]}",
    "null_sort_treatment": "high",
    "number_format": "1,234.56",
    "pivots": [
        {
            "key": "2023-05-08",
            "data": {
                "shipments.assigned_week": "2023-05-08"
            },
            "sort_values": {
                "shipments.assigned_week": "2023-05-08"
            },
            "labels": {
                "shipments.assigned_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>2023-05-08</a>"
            },
            "is_total": false,
            "metadata": {
                "shipments.assigned_week": {
                    "value": "2023-05-08",
                    "filterable_value": "2023-05-08 for 7 days",
                    "links": [
                        {
                            "label": "by Assigned Date",
                            "label_prefix": "by",
                            "label_value": "Assigned Date",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_date&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                            "type": "drill",
                            "type_label": "Drill into 2023-05-08",
                            "type_label_prefix": "Drill into",
                            "type_label_value": "2023-05-08"
                        },
                        {
                            "label": "by Assigned Hour",
                            "label_prefix": "by",
                            "label_value": "Assigned Hour",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_hour&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                            "type": "drill",
                            "type_label": "Drill into 2023-05-08",
                            "type_label_prefix": "Drill into",
                            "type_label_value": "2023-05-08"
                        },
                        {
                            "label": "by Assigned Minute",
                            "label_prefix": "by",
                            "label_value": "Assigned Minute",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_minute&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                            "type": "drill",
                            "type_label": "Drill into 2023-05-08",
                            "type_label_prefix": "Drill into",
                            "type_label_value": "2023-05-08"
                        },
                        {
                            "label": "by Assigned Time",
                            "label_prefix": "by",
                            "label_value": "Assigned Time",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_time&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                            "type": "drill",
                            "type_label": "Drill into 2023-05-08",
                            "type_label_prefix": "Drill into",
                            "type_label_value": "2023-05-08"
                        }
                    ]
                }
            }
        },
        {
            "key": "2023-05-15",
            "data": {
                "shipments.assigned_week": "2023-05-15"
            },
            "sort_values": {
                "shipments.assigned_week": "2023-05-15"
            },
            "labels": {
                "shipments.assigned_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>2023-05-15</a>"
            },
            "is_total": false,
            "metadata": {
                "shipments.assigned_week": {
                    "value": "2023-05-15",
                    "filterable_value": "2023-05-15 for 7 days",
                    "links": [
                        {
                            "label": "by Assigned Date",
                            "label_prefix": "by",
                            "label_value": "Assigned Date",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_date&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                            "type": "drill",
                            "type_label": "Drill into 2023-05-15",
                            "type_label_prefix": "Drill into",
                            "type_label_value": "2023-05-15"
                        },
                        {
                            "label": "by Assigned Hour",
                            "label_prefix": "by",
                            "label_value": "Assigned Hour",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_hour&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                            "type": "drill",
                            "type_label": "Drill into 2023-05-15",
                            "type_label_prefix": "Drill into",
                            "type_label_value": "2023-05-15"
                        },
                        {
                            "label": "by Assigned Minute",
                            "label_prefix": "by",
                            "label_value": "Assigned Minute",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_minute&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                            "type": "drill",
                            "type_label": "Drill into 2023-05-15",
                            "type_label_prefix": "Drill into",
                            "type_label_value": "2023-05-15"
                        },
                        {
                            "label": "by Assigned Time",
                            "label_prefix": "by",
                            "label_value": "Assigned Time",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_time&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                            "type": "drill",
                            "type_label": "Drill into 2023-05-15",
                            "type_label_prefix": "Drill into",
                            "type_label_value": "2023-05-15"
                        }
                    ]
                }
            }
        },
        {
            "key": "2023-05-22",
            "data": {
                "shipments.assigned_week": "2023-05-22"
            },
            "sort_values": {
                "shipments.assigned_week": "2023-05-22"
            },
            "labels": {
                "shipments.assigned_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>2023-05-22</a>"
            },
            "is_total": false,
            "metadata": {
                "shipments.assigned_week": {
                    "value": "2023-05-22",
                    "filterable_value": "2023-05-22 for 7 days",
                    "links": [
                        {
                            "label": "by Assigned Date",
                            "label_prefix": "by",
                            "label_value": "Assigned Date",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_date&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                            "type": "drill",
                            "type_label": "Drill into 2023-05-22",
                            "type_label_prefix": "Drill into",
                            "type_label_value": "2023-05-22"
                        },
                        {
                            "label": "by Assigned Hour",
                            "label_prefix": "by",
                            "label_value": "Assigned Hour",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_hour&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                            "type": "drill",
                            "type_label": "Drill into 2023-05-22",
                            "type_label_prefix": "Drill into",
                            "type_label_value": "2023-05-22"
                        },
                        {
                            "label": "by Assigned Minute",
                            "label_prefix": "by",
                            "label_value": "Assigned Minute",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_minute&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                            "type": "drill",
                            "type_label": "Drill into 2023-05-22",
                            "type_label_prefix": "Drill into",
                            "type_label_value": "2023-05-22"
                        },
                        {
                            "label": "by Assigned Time",
                            "label_prefix": "by",
                            "label_value": "Assigned Time",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_time&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                            "type": "drill",
                            "type_label": "Drill into 2023-05-22",
                            "type_label_prefix": "Drill into",
                            "type_label_value": "2023-05-22"
                        }
                    ]
                }
            }
        },
        {
            "key": "2023-05-29",
            "data": {
                "shipments.assigned_week": "2023-05-29"
            },
            "sort_values": {
                "shipments.assigned_week": "2023-05-29"
            },
            "labels": {
                "shipments.assigned_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>2023-05-29</a>"
            },
            "is_total": false,
            "metadata": {
                "shipments.assigned_week": {
                    "value": "2023-05-29",
                    "filterable_value": "2023-05-29 for 7 days",
                    "links": [
                        {
                            "label": "by Assigned Date",
                            "label_prefix": "by",
                            "label_value": "Assigned Date",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_date&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                            "type": "drill",
                            "type_label": "Drill into 2023-05-29",
                            "type_label_prefix": "Drill into",
                            "type_label_value": "2023-05-29"
                        },
                        {
                            "label": "by Assigned Hour",
                            "label_prefix": "by",
                            "label_value": "Assigned Hour",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_hour&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                            "type": "drill",
                            "type_label": "Drill into 2023-05-29",
                            "type_label_prefix": "Drill into",
                            "type_label_value": "2023-05-29"
                        },
                        {
                            "label": "by Assigned Minute",
                            "label_prefix": "by",
                            "label_value": "Assigned Minute",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_minute&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                            "type": "drill",
                            "type_label": "Drill into 2023-05-29",
                            "type_label_prefix": "Drill into",
                            "type_label_value": "2023-05-29"
                        },
                        {
                            "label": "by Assigned Time",
                            "label_prefix": "by",
                            "label_value": "Assigned Time",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_time&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                            "type": "drill",
                            "type_label": "Drill into 2023-05-29",
                            "type_label_prefix": "Drill into",
                            "type_label_value": "2023-05-29"
                        }
                    ]
                }
            }
        },
        {
            "key": "2023-06-05",
            "data": {
                "shipments.assigned_week": "2023-06-05"
            },
            "sort_values": {
                "shipments.assigned_week": "2023-06-05"
            },
            "labels": {
                "shipments.assigned_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>2023-06-05</a>"
            },
            "is_total": false,
            "metadata": {
                "shipments.assigned_week": {
                    "value": "2023-06-05",
                    "filterable_value": "2023-06-05 for 7 days",
                    "links": [
                        {
                            "label": "by Assigned Date",
                            "label_prefix": "by",
                            "label_value": "Assigned Date",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_date&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                            "type": "drill",
                            "type_label": "Drill into 2023-06-05",
                            "type_label_prefix": "Drill into",
                            "type_label_value": "2023-06-05"
                        },
                        {
                            "label": "by Assigned Hour",
                            "label_prefix": "by",
                            "label_value": "Assigned Hour",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_hour&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                            "type": "drill",
                            "type_label": "Drill into 2023-06-05",
                            "type_label_prefix": "Drill into",
                            "type_label_value": "2023-06-05"
                        },
                        {
                            "label": "by Assigned Minute",
                            "label_prefix": "by",
                            "label_value": "Assigned Minute",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_minute&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                            "type": "drill",
                            "type_label": "Drill into 2023-06-05",
                            "type_label_prefix": "Drill into",
                            "type_label_value": "2023-06-05"
                        },
                        {
                            "label": "by Assigned Time",
                            "label_prefix": "by",
                            "label_value": "Assigned Time",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_time&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                            "type": "drill",
                            "type_label": "Drill into 2023-06-05",
                            "type_label_prefix": "Drill into",
                            "type_label_value": "2023-06-05"
                        }
                    ]
                }
            }
        }
    ],
    "ran_at": "2023-06-06T20:28:47+00:00",
    "sql": "-- raw sql results do not include filled-in values for 'shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier' and 'shipments.assigned_week'\n\n\n-- use existing shipment_transfix_cost_predictions in LOOKER_SCRATCH.LR$YVJY11686081884573_shipment_transfix_cost_predictions\n-- use existing shipment_current_assignment in LOOKER_SCRATCH.LR$YV0XM1686083081005_shipment_current_assignment\nSELECT * FROM (\nSELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank, RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering, CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell FROM (\nSELECT *, MIN(z___rank) OVER (PARTITION BY \"stcp.carrier_rate_as_tcm_percentile_tier__sort_\",\"stcp.carrier_rate_as_tcm_percentile_tier\") as z___min_rank FROM (\nSELECT *, RANK() OVER (ORDER BY \"stcp.carrier_rate_as_tcm_percentile_tier__sort_\" ASC, z__pivot_col_rank, \"stcp.carrier_rate_as_tcm_percentile_tier\") AS z___rank FROM (\nSELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN \"shipments.assigned_week\" IS NULL THEN 1 ELSE 0 END, \"shipments.assigned_week\") AS z__pivot_col_rank FROM (\nSELECT\n    (TO_CHAR(DATE_TRUNC('week', CONVERT_TIMEZONE('UTC', 'America/New_York', CAST((TO_CHAR(DATE_TRUNC('second', shipment_current_assignment.created_second ), 'YYYY-MM-DD HH24:MI:SS'))::timestamp_ntz  AS TIMESTAMP_NTZ))), 'YYYY-MM-DD')) AS \"shipments.assigned_week\",\n    (CASE\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 0 THEN '00'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 10 THEN '01'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 10 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 20 THEN '02'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 20 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 30 THEN '03'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 30 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 40 THEN '04'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 40 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 50 THEN '05'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 50 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 60 THEN '06'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 60 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 70 THEN '07'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 70 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 80 THEN '08'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 80 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 90 THEN '09'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 90 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 100 THEN '10'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 100 THEN '11'\nELSE '12'\nEND\n) AS \"stcp.carrier_rate_as_tcm_percentile_tier__sort_\",\n    (CASE\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 0 THEN 'Below 0'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 10 THEN '0 to 9'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 10 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 20 THEN '10 to 19'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 20 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 30 THEN '20 to 29'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 30 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 40 THEN '30 to 39'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 40 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 50 THEN '40 to 49'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 50 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 60 THEN '50 to 59'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 60 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 70 THEN '60 to 69'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 70 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 80 THEN '70 to 79'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 80 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 90 THEN '80 to 89'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 90 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 100 THEN '90 to 99'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 100 THEN '100 or Above'\nELSE 'Undefined'\nEND\n) AS \"stcp.carrier_rate_as_tcm_percentile_tier\",\n    COUNT(DISTINCT CASE WHEN (CASE WHEN shipments.is_tonu  THEN 1 ELSE 0 END\n) = 0 THEN shipments.id  ELSE NULL END) AS \"shipments.shipment_count\"\nFROM stark_prod.recreated_tables.shipments  AS shipments\nLEFT JOIN LOOKER_SCRATCH.LR$YVJY11686081884573_shipment_transfix_cost_predictions AS shipment_transfix_cost_predictions ON shipment_transfix_cost_predictions.shipment_id=shipments.id\n          and shipment_transfix_cost_predictions.rank_not_assigned=1\n          and (case when shipment_transfix_cost_predictions.synthetic_rate = 'true' then true else false end) = false\n\nLEFT JOIN LOOKER_SCRATCH.LR$YV0XM1686083081005_shipment_current_assignment AS shipment_current_assignment ON shipment_current_assignment.shipment_id = shipments.id\nWHERE ((( (TO_CHAR(DATE_TRUNC('second', shipment_current_assignment.created_second ), 'YYYY-MM-DD HH24:MI:SS'))::timestamp_ntz  ) >= ((CONVERT_TIMEZONE('America/New_York', 'UTC', CAST(DATEADD('day', -29, DATE_TRUNC('day', CONVERT_TIMEZONE('UTC', 'America/New_York', CAST(CURRENT_TIMESTAMP() AS TIMESTAMP_NTZ)))) AS TIMESTAMP_NTZ)))) AND ( (TO_CHAR(DATE_TRUNC('second', shipment_current_assignment.created_second ), 'YYYY-MM-DD HH24:MI:SS'))::timestamp_ntz  ) < ((CONVERT_TIMEZONE('America/New_York', 'UTC', CAST(DATEADD('day', 30, DATEADD('day', -29, DATE_TRUNC('day', CONVERT_TIMEZONE('UTC', 'America/New_York', CAST(CURRENT_TIMESTAMP() AS TIMESTAMP_NTZ))))) AS TIMESTAMP_NTZ))))))\nGROUP BY\n    (DATE_TRUNC('week', CONVERT_TIMEZONE('UTC', 'America/New_York', CAST((TO_CHAR(DATE_TRUNC('second', shipment_current_assignment.created_second ), 'YYYY-MM-DD HH24:MI:SS'))::timestamp_ntz  AS TIMESTAMP_NTZ)))),\n    2,\n    3) ww\n) bb WHERE z__pivot_col_rank <= 16384\n) aa\n) xx\n) zz\n WHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1) ORDER BY z___pivot_row_rank",
    "sql_explain": "EXPLAIN SELECT * FROM (\nSELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank, RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering, CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell FROM (\nSELECT *, MIN(z___rank) OVER (PARTITION BY \"stcp.carrier_rate_as_tcm_percentile_tier__sort_\",\"stcp.carrier_rate_as_tcm_percentile_tier\") as z___min_rank FROM (\nSELECT *, RANK() OVER (ORDER BY \"stcp.carrier_rate_as_tcm_percentile_tier__sort_\" ASC, z__pivot_col_rank, \"stcp.carrier_rate_as_tcm_percentile_tier\") AS z___rank FROM (\nSELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN \"shipments.assigned_week\" IS NULL THEN 1 ELSE 0 END, \"shipments.assigned_week\") AS z__pivot_col_rank FROM (\nSELECT\n    (TO_CHAR(DATE_TRUNC('week', CONVERT_TIMEZONE('UTC', 'America/New_York', CAST((TO_CHAR(DATE_TRUNC('second', shipment_current_assignment.created_second ), 'YYYY-MM-DD HH24:MI:SS'))::timestamp_ntz  AS TIMESTAMP_NTZ))), 'YYYY-MM-DD')) AS \"shipments.assigned_week\",\n    (CASE\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 0 THEN '00'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 10 THEN '01'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 10 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 20 THEN '02'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 20 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 30 THEN '03'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 30 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 40 THEN '04'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 40 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 50 THEN '05'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 50 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 60 THEN '06'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 60 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 70 THEN '07'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 70 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 80 THEN '08'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 80 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 90 THEN '09'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 90 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 100 THEN '10'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 100 THEN '11'\nELSE '12'\nEND\n) AS \"stcp.carrier_rate_as_tcm_percentile_tier__sort_\",\n    (CASE\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 0 THEN 'Below 0'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 10 THEN '0 to 9'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 10 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 20 THEN '10 to 19'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 20 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 30 THEN '20 to 29'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 30 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 40 THEN '30 to 39'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 40 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 50 THEN '40 to 49'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 50 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 60 THEN '50 to 59'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 60 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 70 THEN '60 to 69'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 70 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 80 THEN '70 to 79'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 80 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 90 THEN '80 to 89'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 90 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 100 THEN '90 to 99'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 100 THEN '100 or Above'\nELSE 'Undefined'\nEND\n) AS \"stcp.carrier_rate_as_tcm_percentile_tier\",\n    COUNT(DISTINCT CASE WHEN (CASE WHEN shipments.is_tonu  THEN 1 ELSE 0 END\n) = 0 THEN shipments.id  ELSE NULL END) AS \"shipments.shipment_count\"\nFROM stark_prod.recreated_tables.shipments  AS shipments\nLEFT JOIN LOOKER_SCRATCH.LR$YVJY11686081884573_shipment_transfix_cost_predictions AS shipment_transfix_cost_predictions ON shipment_transfix_cost_predictions.shipment_id=shipments.id\n          and shipment_transfix_cost_predictions.rank_not_assigned=1\n          and (case when shipment_transfix_cost_predictions.synthetic_rate = 'true' then true else false end) = false\n          \nLEFT JOIN LOOKER_SCRATCH.LR$YV0XM1686083081005_shipment_current_assignment AS shipment_current_assignment ON shipment_current_assignment.shipment_id = shipments.id\nWHERE ((( (TO_CHAR(DATE_TRUNC('second', shipment_current_assignment.created_second ), 'YYYY-MM-DD HH24:MI:SS'))::timestamp_ntz  ) >= ((CONVERT_TIMEZONE('America/New_York', 'UTC', CAST(DATEADD('day', -29, DATE_TRUNC('day', CONVERT_TIMEZONE('UTC', 'America/New_York', CAST(CURRENT_TIMESTAMP() AS TIMESTAMP_NTZ)))) AS TIMESTAMP_NTZ)))) AND ( (TO_CHAR(DATE_TRUNC('second', shipment_current_assignment.created_second ), 'YYYY-MM-DD HH24:MI:SS'))::timestamp_ntz  ) < ((CONVERT_TIMEZONE('America/New_York', 'UTC', CAST(DATEADD('day', 30, DATEADD('day', -29, DATE_TRUNC('day', CONVERT_TIMEZONE('UTC', 'America/New_York', CAST(CURRENT_TIMESTAMP() AS TIMESTAMP_NTZ))))) AS TIMESTAMP_NTZ))))))\nGROUP BY\n    (DATE_TRUNC('week', CONVERT_TIMEZONE('UTC', 'America/New_York', CAST((TO_CHAR(DATE_TRUNC('second', shipment_current_assignment.created_second ), 'YYYY-MM-DD HH24:MI:SS'))::timestamp_ntz  AS TIMESTAMP_NTZ)))),\n    2,\n    3) ww\n) bb WHERE z__pivot_col_rank <= 16384\n) aa\n) xx\n) zz\n WHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1) ORDER BY z___pivot_row_rank",
    "supports_pivot_in_db": true,
    "timezone": "America/New_York",
    "is_local": true,
    "table_calcs_complete": true,
    "tracked_attributes": {
        "result.drill_menu_build_time": 0.045551,
        "result.from_cache": false,
        "result.sql.length": 294302,
        "result.supports_pivot_in_db": true
    },
    "pivotTableColumns": [
        [
            {
                "key": "2023-05-08",
                "data": {
                    "shipments.assigned_week": "2023-05-08"
                },
                "sort_values": {
                    "shipments.assigned_week": "2023-05-08"
                },
                "labels": {
                    "shipments.assigned_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>2023-05-08</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_week": {
                        "value": "2023-05-08",
                        "filterable_value": "2023-05-08 for 7 days",
                        "links": [
                            {
                                "label": "by Assigned Date",
                                "label_prefix": "by",
                                "label_value": "Assigned Date",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_date&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-08",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-08"
                            },
                            {
                                "label": "by Assigned Hour",
                                "label_prefix": "by",
                                "label_value": "Assigned Hour",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_hour&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-08",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-08"
                            },
                            {
                                "label": "by Assigned Minute",
                                "label_prefix": "by",
                                "label_value": "Assigned Minute",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_minute&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-08",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-08"
                            },
                            {
                                "label": "by Assigned Time",
                                "label_prefix": "by",
                                "label_value": "Assigned Time",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_time&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-08",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-08"
                            }
                        ]
                    }
                }
            },
            {
                "align": "right",
                "can_filter": true,
                "category": "measure",
                "default_filter_value": null,
                "description": "Count Unique Shipment ID. Does not Include TONUs",
                "enumerations": null,
                "field_group_label": "Counts",
                "fill_style": null,
                "fiscal_month_offset": 0,
                "has_allowed_values": false,
                "hidden": false,
                "is_filter": false,
                "is_numeric": true,
                "label": "Shipments Count Shipments",
                "label_from_parameter": null,
                "label_short": "Count Shipments",
                "map_layer": null,
                "name": "shipments.shipment_count",
                "strict_value_format": false,
                "requires_refresh_on_sort": false,
                "sortable": true,
                "suggestions": null,
                "tags": [],
                "type": "count_distinct",
                "user_attribute_filter_types": [
                    "number",
                    "advanced_filter_number"
                ],
                "value_format": null,
                "view": "shipments",
                "view_label": "Shipments",
                "dynamic": false,
                "week_start_day": "monday",
                "original_view": "shipments",
                "dimension_group": null,
                "error": null,
                "field_group_variant": "Count Shipments",
                "measure": true,
                "parameter": false,
                "primary_key": false,
                "project_name": "snowflake",
                "scope": "shipments",
                "suggest_dimension": "shipments.shipment_count",
                "suggest_explore": "shipments",
                "suggestable": false,
                "is_fiscal": false,
                "is_timeframe": false,
                "can_time_filter": false,
                "time_interval": null,
                "lookml_link": "/projects/snowflake/files/MarketPlace%2FCore%2Fviews%2Fshipments.view.lkml?line=2764",
                "permanent": null,
                "source_file": "MarketPlace/Core/views/shipments.view.lkml",
                "source_file_path": "snowflake/MarketPlace/Core/views/shipments.view.lkml",
                "sql": "${id} ",
                "sql_case": null,
                "filters": [
                    {
                        "field": "shipments.is_tonu",
                        "condition": "No"
                    }
                ],
                "times_used": 0
            }
        ],
        [
            {
                "key": "2023-05-08",
                "data": {
                    "shipments.assigned_week": "2023-05-08"
                },
                "sort_values": {
                    "shipments.assigned_week": "2023-05-08"
                },
                "labels": {
                    "shipments.assigned_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>2023-05-08</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_week": {
                        "value": "2023-05-08",
                        "filterable_value": "2023-05-08 for 7 days",
                        "links": [
                            {
                                "label": "by Assigned Date",
                                "label_prefix": "by",
                                "label_value": "Assigned Date",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_date&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-08",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-08"
                            },
                            {
                                "label": "by Assigned Hour",
                                "label_prefix": "by",
                                "label_value": "Assigned Hour",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_hour&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-08",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-08"
                            },
                            {
                                "label": "by Assigned Minute",
                                "label_prefix": "by",
                                "label_value": "Assigned Minute",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_minute&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-08",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-08"
                            },
                            {
                                "label": "by Assigned Time",
                                "label_prefix": "by",
                                "label_value": "Assigned Time",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_time&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-08",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-08"
                            }
                        ]
                    }
                }
            },
            {
                "label": "test_percent",
                "name": "test_percent",
                "expression": "${shipments.shipment_count} / sum(${shipments.shipment_count})",
                "can_pivot": true,
                "sortable": true,
                "type": "number",
                "align": "right",
                "measure": true,
                "is_table_calculation": true,
                "dynamic": true,
                "value_format": "#,##0%",
                "is_numeric": true
            }
        ],
        [
            {
                "key": "2023-05-15",
                "data": {
                    "shipments.assigned_week": "2023-05-15"
                },
                "sort_values": {
                    "shipments.assigned_week": "2023-05-15"
                },
                "labels": {
                    "shipments.assigned_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>2023-05-15</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_week": {
                        "value": "2023-05-15",
                        "filterable_value": "2023-05-15 for 7 days",
                        "links": [
                            {
                                "label": "by Assigned Date",
                                "label_prefix": "by",
                                "label_value": "Assigned Date",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_date&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-15",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-15"
                            },
                            {
                                "label": "by Assigned Hour",
                                "label_prefix": "by",
                                "label_value": "Assigned Hour",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_hour&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-15",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-15"
                            },
                            {
                                "label": "by Assigned Minute",
                                "label_prefix": "by",
                                "label_value": "Assigned Minute",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_minute&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-15",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-15"
                            },
                            {
                                "label": "by Assigned Time",
                                "label_prefix": "by",
                                "label_value": "Assigned Time",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_time&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-15",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-15"
                            }
                        ]
                    }
                }
            },
            {
                "align": "right",
                "can_filter": true,
                "category": "measure",
                "default_filter_value": null,
                "description": "Count Unique Shipment ID. Does not Include TONUs",
                "enumerations": null,
                "field_group_label": "Counts",
                "fill_style": null,
                "fiscal_month_offset": 0,
                "has_allowed_values": false,
                "hidden": false,
                "is_filter": false,
                "is_numeric": true,
                "label": "Shipments Count Shipments",
                "label_from_parameter": null,
                "label_short": "Count Shipments",
                "map_layer": null,
                "name": "shipments.shipment_count",
                "strict_value_format": false,
                "requires_refresh_on_sort": false,
                "sortable": true,
                "suggestions": null,
                "tags": [],
                "type": "count_distinct",
                "user_attribute_filter_types": [
                    "number",
                    "advanced_filter_number"
                ],
                "value_format": null,
                "view": "shipments",
                "view_label": "Shipments",
                "dynamic": false,
                "week_start_day": "monday",
                "original_view": "shipments",
                "dimension_group": null,
                "error": null,
                "field_group_variant": "Count Shipments",
                "measure": true,
                "parameter": false,
                "primary_key": false,
                "project_name": "snowflake",
                "scope": "shipments",
                "suggest_dimension": "shipments.shipment_count",
                "suggest_explore": "shipments",
                "suggestable": false,
                "is_fiscal": false,
                "is_timeframe": false,
                "can_time_filter": false,
                "time_interval": null,
                "lookml_link": "/projects/snowflake/files/MarketPlace%2FCore%2Fviews%2Fshipments.view.lkml?line=2764",
                "permanent": null,
                "source_file": "MarketPlace/Core/views/shipments.view.lkml",
                "source_file_path": "snowflake/MarketPlace/Core/views/shipments.view.lkml",
                "sql": "${id} ",
                "sql_case": null,
                "filters": [
                    {
                        "field": "shipments.is_tonu",
                        "condition": "No"
                    }
                ],
                "times_used": 0
            }
        ],
        [
            {
                "key": "2023-05-15",
                "data": {
                    "shipments.assigned_week": "2023-05-15"
                },
                "sort_values": {
                    "shipments.assigned_week": "2023-05-15"
                },
                "labels": {
                    "shipments.assigned_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>2023-05-15</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_week": {
                        "value": "2023-05-15",
                        "filterable_value": "2023-05-15 for 7 days",
                        "links": [
                            {
                                "label": "by Assigned Date",
                                "label_prefix": "by",
                                "label_value": "Assigned Date",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_date&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-15",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-15"
                            },
                            {
                                "label": "by Assigned Hour",
                                "label_prefix": "by",
                                "label_value": "Assigned Hour",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_hour&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-15",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-15"
                            },
                            {
                                "label": "by Assigned Minute",
                                "label_prefix": "by",
                                "label_value": "Assigned Minute",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_minute&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-15",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-15"
                            },
                            {
                                "label": "by Assigned Time",
                                "label_prefix": "by",
                                "label_value": "Assigned Time",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_time&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-15",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-15"
                            }
                        ]
                    }
                }
            },
            {
                "label": "test_percent",
                "name": "test_percent",
                "expression": "${shipments.shipment_count} / sum(${shipments.shipment_count})",
                "can_pivot": true,
                "sortable": true,
                "type": "number",
                "align": "right",
                "measure": true,
                "is_table_calculation": true,
                "dynamic": true,
                "value_format": "#,##0%",
                "is_numeric": true
            }
        ],
        [
            {
                "key": "2023-05-22",
                "data": {
                    "shipments.assigned_week": "2023-05-22"
                },
                "sort_values": {
                    "shipments.assigned_week": "2023-05-22"
                },
                "labels": {
                    "shipments.assigned_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>2023-05-22</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_week": {
                        "value": "2023-05-22",
                        "filterable_value": "2023-05-22 for 7 days",
                        "links": [
                            {
                                "label": "by Assigned Date",
                                "label_prefix": "by",
                                "label_value": "Assigned Date",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_date&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-22",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-22"
                            },
                            {
                                "label": "by Assigned Hour",
                                "label_prefix": "by",
                                "label_value": "Assigned Hour",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_hour&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-22",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-22"
                            },
                            {
                                "label": "by Assigned Minute",
                                "label_prefix": "by",
                                "label_value": "Assigned Minute",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_minute&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-22",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-22"
                            },
                            {
                                "label": "by Assigned Time",
                                "label_prefix": "by",
                                "label_value": "Assigned Time",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_time&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-22",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-22"
                            }
                        ]
                    }
                }
            },
            {
                "align": "right",
                "can_filter": true,
                "category": "measure",
                "default_filter_value": null,
                "description": "Count Unique Shipment ID. Does not Include TONUs",
                "enumerations": null,
                "field_group_label": "Counts",
                "fill_style": null,
                "fiscal_month_offset": 0,
                "has_allowed_values": false,
                "hidden": false,
                "is_filter": false,
                "is_numeric": true,
                "label": "Shipments Count Shipments",
                "label_from_parameter": null,
                "label_short": "Count Shipments",
                "map_layer": null,
                "name": "shipments.shipment_count",
                "strict_value_format": false,
                "requires_refresh_on_sort": false,
                "sortable": true,
                "suggestions": null,
                "tags": [],
                "type": "count_distinct",
                "user_attribute_filter_types": [
                    "number",
                    "advanced_filter_number"
                ],
                "value_format": null,
                "view": "shipments",
                "view_label": "Shipments",
                "dynamic": false,
                "week_start_day": "monday",
                "original_view": "shipments",
                "dimension_group": null,
                "error": null,
                "field_group_variant": "Count Shipments",
                "measure": true,
                "parameter": false,
                "primary_key": false,
                "project_name": "snowflake",
                "scope": "shipments",
                "suggest_dimension": "shipments.shipment_count",
                "suggest_explore": "shipments",
                "suggestable": false,
                "is_fiscal": false,
                "is_timeframe": false,
                "can_time_filter": false,
                "time_interval": null,
                "lookml_link": "/projects/snowflake/files/MarketPlace%2FCore%2Fviews%2Fshipments.view.lkml?line=2764",
                "permanent": null,
                "source_file": "MarketPlace/Core/views/shipments.view.lkml",
                "source_file_path": "snowflake/MarketPlace/Core/views/shipments.view.lkml",
                "sql": "${id} ",
                "sql_case": null,
                "filters": [
                    {
                        "field": "shipments.is_tonu",
                        "condition": "No"
                    }
                ],
                "times_used": 0
            }
        ],
        [
            {
                "key": "2023-05-22",
                "data": {
                    "shipments.assigned_week": "2023-05-22"
                },
                "sort_values": {
                    "shipments.assigned_week": "2023-05-22"
                },
                "labels": {
                    "shipments.assigned_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>2023-05-22</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_week": {
                        "value": "2023-05-22",
                        "filterable_value": "2023-05-22 for 7 days",
                        "links": [
                            {
                                "label": "by Assigned Date",
                                "label_prefix": "by",
                                "label_value": "Assigned Date",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_date&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-22",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-22"
                            },
                            {
                                "label": "by Assigned Hour",
                                "label_prefix": "by",
                                "label_value": "Assigned Hour",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_hour&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-22",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-22"
                            },
                            {
                                "label": "by Assigned Minute",
                                "label_prefix": "by",
                                "label_value": "Assigned Minute",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_minute&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-22",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-22"
                            },
                            {
                                "label": "by Assigned Time",
                                "label_prefix": "by",
                                "label_value": "Assigned Time",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_time&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-22",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-22"
                            }
                        ]
                    }
                }
            },
            {
                "label": "test_percent",
                "name": "test_percent",
                "expression": "${shipments.shipment_count} / sum(${shipments.shipment_count})",
                "can_pivot": true,
                "sortable": true,
                "type": "number",
                "align": "right",
                "measure": true,
                "is_table_calculation": true,
                "dynamic": true,
                "value_format": "#,##0%",
                "is_numeric": true
            }
        ],
        [
            {
                "key": "2023-05-29",
                "data": {
                    "shipments.assigned_week": "2023-05-29"
                },
                "sort_values": {
                    "shipments.assigned_week": "2023-05-29"
                },
                "labels": {
                    "shipments.assigned_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>2023-05-29</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_week": {
                        "value": "2023-05-29",
                        "filterable_value": "2023-05-29 for 7 days",
                        "links": [
                            {
                                "label": "by Assigned Date",
                                "label_prefix": "by",
                                "label_value": "Assigned Date",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_date&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-29",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-29"
                            },
                            {
                                "label": "by Assigned Hour",
                                "label_prefix": "by",
                                "label_value": "Assigned Hour",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_hour&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-29",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-29"
                            },
                            {
                                "label": "by Assigned Minute",
                                "label_prefix": "by",
                                "label_value": "Assigned Minute",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_minute&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-29",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-29"
                            },
                            {
                                "label": "by Assigned Time",
                                "label_prefix": "by",
                                "label_value": "Assigned Time",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_time&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-29",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-29"
                            }
                        ]
                    }
                }
            },
            {
                "align": "right",
                "can_filter": true,
                "category": "measure",
                "default_filter_value": null,
                "description": "Count Unique Shipment ID. Does not Include TONUs",
                "enumerations": null,
                "field_group_label": "Counts",
                "fill_style": null,
                "fiscal_month_offset": 0,
                "has_allowed_values": false,
                "hidden": false,
                "is_filter": false,
                "is_numeric": true,
                "label": "Shipments Count Shipments",
                "label_from_parameter": null,
                "label_short": "Count Shipments",
                "map_layer": null,
                "name": "shipments.shipment_count",
                "strict_value_format": false,
                "requires_refresh_on_sort": false,
                "sortable": true,
                "suggestions": null,
                "tags": [],
                "type": "count_distinct",
                "user_attribute_filter_types": [
                    "number",
                    "advanced_filter_number"
                ],
                "value_format": null,
                "view": "shipments",
                "view_label": "Shipments",
                "dynamic": false,
                "week_start_day": "monday",
                "original_view": "shipments",
                "dimension_group": null,
                "error": null,
                "field_group_variant": "Count Shipments",
                "measure": true,
                "parameter": false,
                "primary_key": false,
                "project_name": "snowflake",
                "scope": "shipments",
                "suggest_dimension": "shipments.shipment_count",
                "suggest_explore": "shipments",
                "suggestable": false,
                "is_fiscal": false,
                "is_timeframe": false,
                "can_time_filter": false,
                "time_interval": null,
                "lookml_link": "/projects/snowflake/files/MarketPlace%2FCore%2Fviews%2Fshipments.view.lkml?line=2764",
                "permanent": null,
                "source_file": "MarketPlace/Core/views/shipments.view.lkml",
                "source_file_path": "snowflake/MarketPlace/Core/views/shipments.view.lkml",
                "sql": "${id} ",
                "sql_case": null,
                "filters": [
                    {
                        "field": "shipments.is_tonu",
                        "condition": "No"
                    }
                ],
                "times_used": 0
            }
        ],
        [
            {
                "key": "2023-05-29",
                "data": {
                    "shipments.assigned_week": "2023-05-29"
                },
                "sort_values": {
                    "shipments.assigned_week": "2023-05-29"
                },
                "labels": {
                    "shipments.assigned_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>2023-05-29</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_week": {
                        "value": "2023-05-29",
                        "filterable_value": "2023-05-29 for 7 days",
                        "links": [
                            {
                                "label": "by Assigned Date",
                                "label_prefix": "by",
                                "label_value": "Assigned Date",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_date&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-29",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-29"
                            },
                            {
                                "label": "by Assigned Hour",
                                "label_prefix": "by",
                                "label_value": "Assigned Hour",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_hour&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-29",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-29"
                            },
                            {
                                "label": "by Assigned Minute",
                                "label_prefix": "by",
                                "label_value": "Assigned Minute",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_minute&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-29",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-29"
                            },
                            {
                                "label": "by Assigned Time",
                                "label_prefix": "by",
                                "label_value": "Assigned Time",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_time&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-05-29",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-05-29"
                            }
                        ]
                    }
                }
            },
            {
                "label": "test_percent",
                "name": "test_percent",
                "expression": "${shipments.shipment_count} / sum(${shipments.shipment_count})",
                "can_pivot": true,
                "sortable": true,
                "type": "number",
                "align": "right",
                "measure": true,
                "is_table_calculation": true,
                "dynamic": true,
                "value_format": "#,##0%",
                "is_numeric": true
            }
        ],
        [
            {
                "key": "2023-06-05",
                "data": {
                    "shipments.assigned_week": "2023-06-05"
                },
                "sort_values": {
                    "shipments.assigned_week": "2023-06-05"
                },
                "labels": {
                    "shipments.assigned_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>2023-06-05</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_week": {
                        "value": "2023-06-05",
                        "filterable_value": "2023-06-05 for 7 days",
                        "links": [
                            {
                                "label": "by Assigned Date",
                                "label_prefix": "by",
                                "label_value": "Assigned Date",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_date&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-06-05",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-06-05"
                            },
                            {
                                "label": "by Assigned Hour",
                                "label_prefix": "by",
                                "label_value": "Assigned Hour",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_hour&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-06-05",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-06-05"
                            },
                            {
                                "label": "by Assigned Minute",
                                "label_prefix": "by",
                                "label_value": "Assigned Minute",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_minute&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-06-05",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-06-05"
                            },
                            {
                                "label": "by Assigned Time",
                                "label_prefix": "by",
                                "label_value": "Assigned Time",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_time&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-06-05",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-06-05"
                            }
                        ]
                    }
                }
            },
            {
                "align": "right",
                "can_filter": true,
                "category": "measure",
                "default_filter_value": null,
                "description": "Count Unique Shipment ID. Does not Include TONUs",
                "enumerations": null,
                "field_group_label": "Counts",
                "fill_style": null,
                "fiscal_month_offset": 0,
                "has_allowed_values": false,
                "hidden": false,
                "is_filter": false,
                "is_numeric": true,
                "label": "Shipments Count Shipments",
                "label_from_parameter": null,
                "label_short": "Count Shipments",
                "map_layer": null,
                "name": "shipments.shipment_count",
                "strict_value_format": false,
                "requires_refresh_on_sort": false,
                "sortable": true,
                "suggestions": null,
                "tags": [],
                "type": "count_distinct",
                "user_attribute_filter_types": [
                    "number",
                    "advanced_filter_number"
                ],
                "value_format": null,
                "view": "shipments",
                "view_label": "Shipments",
                "dynamic": false,
                "week_start_day": "monday",
                "original_view": "shipments",
                "dimension_group": null,
                "error": null,
                "field_group_variant": "Count Shipments",
                "measure": true,
                "parameter": false,
                "primary_key": false,
                "project_name": "snowflake",
                "scope": "shipments",
                "suggest_dimension": "shipments.shipment_count",
                "suggest_explore": "shipments",
                "suggestable": false,
                "is_fiscal": false,
                "is_timeframe": false,
                "can_time_filter": false,
                "time_interval": null,
                "lookml_link": "/projects/snowflake/files/MarketPlace%2FCore%2Fviews%2Fshipments.view.lkml?line=2764",
                "permanent": null,
                "source_file": "MarketPlace/Core/views/shipments.view.lkml",
                "source_file_path": "snowflake/MarketPlace/Core/views/shipments.view.lkml",
                "sql": "${id} ",
                "sql_case": null,
                "filters": [
                    {
                        "field": "shipments.is_tonu",
                        "condition": "No"
                    }
                ],
                "times_used": 0
            }
        ],
        [
            {
                "key": "2023-06-05",
                "data": {
                    "shipments.assigned_week": "2023-06-05"
                },
                "sort_values": {
                    "shipments.assigned_week": "2023-06-05"
                },
                "labels": {
                    "shipments.assigned_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>2023-06-05</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_week": {
                        "value": "2023-06-05",
                        "filterable_value": "2023-06-05 for 7 days",
                        "links": [
                            {
                                "label": "by Assigned Date",
                                "label_prefix": "by",
                                "label_value": "Assigned Date",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_date&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-06-05",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-06-05"
                            },
                            {
                                "label": "by Assigned Hour",
                                "label_prefix": "by",
                                "label_value": "Assigned Hour",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_hour&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-06-05",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-06-05"
                            },
                            {
                                "label": "by Assigned Minute",
                                "label_prefix": "by",
                                "label_value": "Assigned Minute",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_minute&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-06-05",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-06-05"
                            },
                            {
                                "label": "by Assigned Time",
                                "label_prefix": "by",
                                "label_value": "Assigned Time",
                                "url": "/explore/snowflake_marketplace/shipments?fields=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.shipment_count,shipments.assigned_time&pivots=shipments.assigned_week&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&sorts=shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier,shipments.assigned_week&limit=500&column_limit=50&dynamic_fields=%5B%7B%22category%22%3A%22table_calculation%22%2C%22expression%22%3A%22%24%7Bshipments.shipment_count%7D+%2F+sum%28%24%7Bshipments.shipment_count%7D%29%22%2C%22label%22%3A%22test_percent%22%2C%22value_format%22%3Anull%2C%22value_format_name%22%3A%22percent_0%22%2C%22_kind_hint%22%3A%22measure%22%2C%22table_calculation%22%3A%22test_percent%22%2C%22_type_hint%22%3A%22number%22%7D%5D",
                                "type": "drill",
                                "type_label": "Drill into 2023-06-05",
                                "type_label_prefix": "Drill into",
                                "type_label_value": "2023-06-05"
                            }
                        ]
                    }
                }
            },
            {
                "label": "test_percent",
                "name": "test_percent",
                "expression": "${shipments.shipment_count} / sum(${shipments.shipment_count})",
                "can_pivot": true,
                "sortable": true,
                "type": "number",
                "align": "right",
                "measure": true,
                "is_table_calculation": true,
                "dynamic": true,
                "value_format": "#,##0%",
                "is_numeric": true
            }
        ]
    ],
    "sorts": []
}, "data": [
    {
        "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
            "value": "Below 0",
            "sort_value": "00"
        },
        "shipments.shipment_count": {
            "2023-05-08": {
                "value": null
            },
            "2023-05-15": {
                "value": null
            },
            "2023-05-22": {
                "value": null
            },
            "2023-05-29": {
                "value": null
            },
            "2023-06-05": {
                "value": null
            }
        },
        "test_percent": {
            "2023-05-08": {
                "value": null,
                "rendered": "null"
            },
            "2023-05-15": {
                "value": null,
                "rendered": "null"
            },
            "2023-05-22": {
                "value": null,
                "rendered": "null"
            },
            "2023-05-29": {
                "value": null,
                "rendered": "null"
            },
            "2023-06-05": {
                "value": null,
                "rendered": "null"
            }
        }
    },
    {
        "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
            "value": "0 to 9",
            "sort_value": "01"
        },
        "shipments.shipment_count": {
            "2023-05-08": {
                "value": null
            },
            "2023-05-15": {
                "value": null
            },
            "2023-05-22": {
                "value": null
            },
            "2023-05-29": {
                "value": null
            },
            "2023-06-05": {
                "value": null
            }
        },
        "test_percent": {
            "2023-05-08": {
                "value": null,
                "rendered": "null"
            },
            "2023-05-15": {
                "value": null,
                "rendered": "null"
            },
            "2023-05-22": {
                "value": null,
                "rendered": "null"
            },
            "2023-05-29": {
                "value": null,
                "rendered": "null"
            },
            "2023-06-05": {
                "value": null,
                "rendered": "null"
            }
        }
    },
    {
        "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
            "value": "10 to 19",
            "sort_value": "02"
        },
        "shipments.shipment_count": {
            "2023-05-08": {
                "value": 792,
                "links": [
                    {
                        "label": "Show All 792",
                        "label_prefix": "Show All",
                        "label_value": "792",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=10+to+19&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-15": {
                "value": 417,
                "links": [
                    {
                        "label": "Show All 417",
                        "label_prefix": "Show All",
                        "label_value": "417",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=10+to+19&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-22": {
                "value": 742,
                "links": [
                    {
                        "label": "Show All 742",
                        "label_prefix": "Show All",
                        "label_value": "742",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=10+to+19&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-29": {
                "value": 814,
                "links": [
                    {
                        "label": "Show All 814",
                        "label_prefix": "Show All",
                        "label_value": "814",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=10+to+19&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-06-05": {
                "value": 441,
                "links": [
                    {
                        "label": "Show All 441",
                        "label_prefix": "Show All",
                        "label_value": "441",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=10+to+19&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            }
        },
        "test_percent": {
            "2023-05-08": {
                "value": 0.23259911894273128,
                "rendered": "23%"
            },
            "2023-05-15": {
                "value": 0.12311780336581045,
                "rendered": "12%"
            },
            "2023-05-22": {
                "value": 0.21334100057504313,
                "rendered": "21%"
            },
            "2023-05-29": {
                "value": 0.24969325153374233,
                "rendered": "25%"
            },
            "2023-06-05": {
                "value": 0.2791139240506329,
                "rendered": "28%"
            }
        }
    },
    {
        "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
            "value": "20 to 29",
            "sort_value": "03"
        },
        "shipments.shipment_count": {
            "2023-05-08": {
                "value": 510,
                "links": [
                    {
                        "label": "Show All 510",
                        "label_prefix": "Show All",
                        "label_value": "510",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=20+to+29&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-15": {
                "value": 280,
                "links": [
                    {
                        "label": "Show All 280",
                        "label_prefix": "Show All",
                        "label_value": "280",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=20+to+29&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-22": {
                "value": 420,
                "links": [
                    {
                        "label": "Show All 420",
                        "label_prefix": "Show All",
                        "label_value": "420",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=20+to+29&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-29": {
                "value": 464,
                "links": [
                    {
                        "label": "Show All 464",
                        "label_prefix": "Show All",
                        "label_value": "464",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=20+to+29&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-06-05": {
                "value": 249,
                "links": [
                    {
                        "label": "Show All 249",
                        "label_prefix": "Show All",
                        "label_value": "249",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=20+to+29&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            }
        },
        "test_percent": {
            "2023-05-08": {
                "value": 0.14977973568281938,
                "rendered": "15%"
            },
            "2023-05-15": {
                "value": 0.0826690286389135,
                "rendered": "8%"
            },
            "2023-05-22": {
                "value": 0.12075905692926969,
                "rendered": "12%"
            },
            "2023-05-29": {
                "value": 0.1423312883435583,
                "rendered": "14%"
            },
            "2023-06-05": {
                "value": 0.15759493670886077,
                "rendered": "16%"
            }
        }
    },
    {
        "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
            "value": "30 to 39",
            "sort_value": "04"
        },
        "shipments.shipment_count": {
            "2023-05-08": {
                "value": 231,
                "links": [
                    {
                        "label": "Show All 231",
                        "label_prefix": "Show All",
                        "label_value": "231",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=30+to+39&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-15": {
                "value": 267,
                "links": [
                    {
                        "label": "Show All 267",
                        "label_prefix": "Show All",
                        "label_value": "267",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=30+to+39&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-22": {
                "value": 218,
                "links": [
                    {
                        "label": "Show All 218",
                        "label_prefix": "Show All",
                        "label_value": "218",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=30+to+39&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-29": {
                "value": 280,
                "links": [
                    {
                        "label": "Show All 280",
                        "label_prefix": "Show All",
                        "label_value": "280",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=30+to+39&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-06-05": {
                "value": 72,
                "links": [
                    {
                        "label": "Show All 72",
                        "label_prefix": "Show All",
                        "label_value": "72",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=30+to+39&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            }
        },
        "test_percent": {
            "2023-05-08": {
                "value": 0.06784140969162995,
                "rendered": "7%"
            },
            "2023-05-15": {
                "value": 0.07883082373782108,
                "rendered": "8%"
            },
            "2023-05-22": {
                "value": 0.06267970097757332,
                "rendered": "6%"
            },
            "2023-05-29": {
                "value": 0.08588957055214724,
                "rendered": "9%"
            },
            "2023-06-05": {
                "value": 0.04556962025316456,
                "rendered": "5%"
            }
        }
    },
    {
        "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
            "value": "40 to 49",
            "sort_value": "05"
        },
        "shipments.shipment_count": {
            "2023-05-08": {
                "value": 237,
                "links": [
                    {
                        "label": "Show All 237",
                        "label_prefix": "Show All",
                        "label_value": "237",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=40+to+49&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-15": {
                "value": 194,
                "links": [
                    {
                        "label": "Show All 194",
                        "label_prefix": "Show All",
                        "label_value": "194",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=40+to+49&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-22": {
                "value": 195,
                "links": [
                    {
                        "label": "Show All 195",
                        "label_prefix": "Show All",
                        "label_value": "195",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=40+to+49&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-29": {
                "value": 210,
                "links": [
                    {
                        "label": "Show All 210",
                        "label_prefix": "Show All",
                        "label_value": "210",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=40+to+49&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-06-05": {
                "value": 97,
                "links": [
                    {
                        "label": "Show All 97",
                        "label_prefix": "Show All",
                        "label_value": "97",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=40+to+49&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            }
        },
        "test_percent": {
            "2023-05-08": {
                "value": 0.06960352422907488,
                "rendered": "7%"
            },
            "2023-05-15": {
                "value": 0.05727782698553292,
                "rendered": "6%"
            },
            "2023-05-22": {
                "value": 0.056066705002875215,
                "rendered": "6%"
            },
            "2023-05-29": {
                "value": 0.06441717791411043,
                "rendered": "6%"
            },
            "2023-06-05": {
                "value": 0.06139240506329114,
                "rendered": "6%"
            }
        }
    },
    {
        "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
            "value": "50 to 59",
            "sort_value": "06"
        },
        "shipments.shipment_count": {
            "2023-05-08": {
                "value": 237,
                "links": [
                    {
                        "label": "Show All 237",
                        "label_prefix": "Show All",
                        "label_value": "237",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=50+to+59&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-15": {
                "value": 204,
                "links": [
                    {
                        "label": "Show All 204",
                        "label_prefix": "Show All",
                        "label_value": "204",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=50+to+59&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-22": {
                "value": 234,
                "links": [
                    {
                        "label": "Show All 234",
                        "label_prefix": "Show All",
                        "label_value": "234",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=50+to+59&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-29": {
                "value": 268,
                "links": [
                    {
                        "label": "Show All 268",
                        "label_prefix": "Show All",
                        "label_value": "268",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=50+to+59&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-06-05": {
                "value": 135,
                "links": [
                    {
                        "label": "Show All 135",
                        "label_prefix": "Show All",
                        "label_value": "135",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=50+to+59&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            }
        },
        "test_percent": {
            "2023-05-08": {
                "value": 0.06960352422907488,
                "rendered": "7%"
            },
            "2023-05-15": {
                "value": 0.06023029229406555,
                "rendered": "6%"
            },
            "2023-05-22": {
                "value": 0.06728004600345026,
                "rendered": "7%"
            },
            "2023-05-29": {
                "value": 0.08220858895705521,
                "rendered": "8%"
            },
            "2023-06-05": {
                "value": 0.08544303797468354,
                "rendered": "9%"
            }
        }
    },
    {
        "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
            "value": "60 to 69",
            "sort_value": "07"
        },
        "shipments.shipment_count": {
            "2023-05-08": {
                "value": 258,
                "links": [
                    {
                        "label": "Show All 258",
                        "label_prefix": "Show All",
                        "label_value": "258",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=60+to+69&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-15": {
                "value": 244,
                "links": [
                    {
                        "label": "Show All 244",
                        "label_prefix": "Show All",
                        "label_value": "244",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=60+to+69&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-22": {
                "value": 240,
                "links": [
                    {
                        "label": "Show All 240",
                        "label_prefix": "Show All",
                        "label_value": "240",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=60+to+69&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-29": {
                "value": 181,
                "links": [
                    {
                        "label": "Show All 181",
                        "label_prefix": "Show All",
                        "label_value": "181",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=60+to+69&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-06-05": {
                "value": 138,
                "links": [
                    {
                        "label": "Show All 138",
                        "label_prefix": "Show All",
                        "label_value": "138",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=60+to+69&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            }
        },
        "test_percent": {
            "2023-05-08": {
                "value": 0.07577092511013216,
                "rendered": "8%"
            },
            "2023-05-15": {
                "value": 0.07204015352819604,
                "rendered": "7%"
            },
            "2023-05-22": {
                "value": 0.06900517538815411,
                "rendered": "7%"
            },
            "2023-05-29": {
                "value": 0.055521472392638035,
                "rendered": "6%"
            },
            "2023-06-05": {
                "value": 0.08734177215189873,
                "rendered": "9%"
            }
        }
    },
    {
        "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
            "value": "70 to 79",
            "sort_value": "08"
        },
        "shipments.shipment_count": {
            "2023-05-08": {
                "value": 339,
                "links": [
                    {
                        "label": "Show All 339",
                        "label_prefix": "Show All",
                        "label_value": "339",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=70+to+79&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-15": {
                "value": 330,
                "links": [
                    {
                        "label": "Show All 330",
                        "label_prefix": "Show All",
                        "label_value": "330",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=70+to+79&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-22": {
                "value": 365,
                "links": [
                    {
                        "label": "Show All 365",
                        "label_prefix": "Show All",
                        "label_value": "365",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=70+to+79&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-29": {
                "value": 299,
                "links": [
                    {
                        "label": "Show All 299",
                        "label_prefix": "Show All",
                        "label_value": "299",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=70+to+79&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-06-05": {
                "value": 133,
                "links": [
                    {
                        "label": "Show All 133",
                        "label_prefix": "Show All",
                        "label_value": "133",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=70+to+79&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            }
        },
        "test_percent": {
            "2023-05-08": {
                "value": 0.09955947136563877,
                "rendered": "10%"
            },
            "2023-05-15": {
                "value": 0.09743135518157661,
                "rendered": "10%"
            },
            "2023-05-22": {
                "value": 0.1049453709028177,
                "rendered": "10%"
            },
            "2023-05-29": {
                "value": 0.09171779141104294,
                "rendered": "9%"
            },
            "2023-06-05": {
                "value": 0.08417721518987342,
                "rendered": "8%"
            }
        }
    },
    {
        "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
            "value": "80 to 89",
            "sort_value": "09"
        },
        "shipments.shipment_count": {
            "2023-05-08": {
                "value": 285,
                "links": [
                    {
                        "label": "Show All 285",
                        "label_prefix": "Show All",
                        "label_value": "285",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=80+to+89&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-15": {
                "value": 366,
                "links": [
                    {
                        "label": "Show All 366",
                        "label_prefix": "Show All",
                        "label_value": "366",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=80+to+89&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-22": {
                "value": 334,
                "links": [
                    {
                        "label": "Show All 334",
                        "label_prefix": "Show All",
                        "label_value": "334",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=80+to+89&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-29": {
                "value": 233,
                "links": [
                    {
                        "label": "Show All 233",
                        "label_prefix": "Show All",
                        "label_value": "233",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=80+to+89&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-06-05": {
                "value": 129,
                "links": [
                    {
                        "label": "Show All 129",
                        "label_prefix": "Show All",
                        "label_value": "129",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=80+to+89&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            }
        },
        "test_percent": {
            "2023-05-08": {
                "value": 0.08370044052863436,
                "rendered": "8%"
            },
            "2023-05-15": {
                "value": 0.10806023029229407,
                "rendered": "11%"
            },
            "2023-05-22": {
                "value": 0.09603220241518114,
                "rendered": "10%"
            },
            "2023-05-29": {
                "value": 0.07147239263803681,
                "rendered": "7%"
            },
            "2023-06-05": {
                "value": 0.08164556962025317,
                "rendered": "8%"
            }
        }
    },
    {
        "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
            "value": "90 to 99",
            "sort_value": "10"
        },
        "shipments.shipment_count": {
            "2023-05-08": {
                "value": 516,
                "links": [
                    {
                        "label": "Show All 516",
                        "label_prefix": "Show All",
                        "label_value": "516",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-08+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=90+to+99&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-15": {
                "value": 1085,
                "rendered": "1,085",
                "links": [
                    {
                        "label": "Show All 1,085",
                        "label_prefix": "Show All",
                        "label_value": "1,085",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-15+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=90+to+99&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-22": {
                "value": 730,
                "links": [
                    {
                        "label": "Show All 730",
                        "label_prefix": "Show All",
                        "label_value": "730",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-22+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=90+to+99&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-05-29": {
                "value": 511,
                "links": [
                    {
                        "label": "Show All 511",
                        "label_prefix": "Show All",
                        "label_value": "511",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-05-29+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=90+to+99&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "2023-06-05": {
                "value": 186,
                "links": [
                    {
                        "label": "Show All 186",
                        "label_prefix": "Show All",
                        "label_value": "186",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_date]=30+days&f[shipments.assigned_week]=2023-06-05+for+7+days&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=90+to+99&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            }
        },
        "test_percent": {
            "2023-05-08": {
                "value": 0.1515418502202643,
                "rendered": "15%"
            },
            "2023-05-15": {
                "value": 0.3203424859757898,
                "rendered": "32%"
            },
            "2023-05-22": {
                "value": 0.2098907418056354,
                "rendered": "21%"
            },
            "2023-05-29": {
                "value": 0.15674846625766872,
                "rendered": "16%"
            },
            "2023-06-05": {
                "value": 0.11772151898734177,
                "rendered": "12%"
            }
        }
    },
    {
        "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
            "value": "100 or Above",
            "sort_value": "11"
        },
        "shipments.shipment_count": {
            "2023-05-08": {
                "value": null
            },
            "2023-05-15": {
                "value": null
            },
            "2023-05-22": {
                "value": null
            },
            "2023-05-29": {
                "value": null
            },
            "2023-06-05": {
                "value": null
            }
        },
        "test_percent": {
            "2023-05-08": {
                "value": null,
                "rendered": "null"
            },
            "2023-05-15": {
                "value": null,
                "rendered": "null"
            },
            "2023-05-22": {
                "value": null,
                "rendered": "null"
            },
            "2023-05-29": {
                "value": null,
                "rendered": "null"
            },
            "2023-06-05": {
                "value": null,
                "rendered": "null"
            }
        }
    }
]
}