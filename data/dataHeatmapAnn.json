{"queryResponse": {
    "parent_id": "d0c6511cb1fca127a6123d680c001498",
    "sql_changed": true,
    "aggregate_table_used_info": null,
    "added_params": null,
    "cached_derived": true,
    "data": [
        {
            "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
                "value": "T01 [10.0,10.01)",
                "filterable_value": "\"T01 [10.0,10.01)\"",
                "sort_value": "01"
            },
            "shipments.shipment_count": {
                "Monday|FIELD|0": {
                    "value": 433,
                    "links": [
                        {
                            "label": "Show All 433",
                            "label_prefix": "Show All",
                            "label_value": "433",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Monday&f[shipments.assigned_day_of_week_index]=0&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T01+%5B10.0%2C10.01%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Tuesday|FIELD|1": {
                    "value": 432,
                    "links": [
                        {
                            "label": "Show All 432",
                            "label_prefix": "Show All",
                            "label_value": "432",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Tuesday&f[shipments.assigned_day_of_week_index]=1&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T01+%5B10.0%2C10.01%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Wednesday|FIELD|2": {
                    "value": 271,
                    "links": [
                        {
                            "label": "Show All 271",
                            "label_prefix": "Show All",
                            "label_value": "271",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Wednesday&f[shipments.assigned_day_of_week_index]=2&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T01+%5B10.0%2C10.01%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Thursday|FIELD|3": {
                    "value": 270,
                    "links": [
                        {
                            "label": "Show All 270",
                            "label_prefix": "Show All",
                            "label_value": "270",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Thursday&f[shipments.assigned_day_of_week_index]=3&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T01+%5B10.0%2C10.01%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Friday|FIELD|4": {
                    "value": 261,
                    "links": [
                        {
                            "label": "Show All 261",
                            "label_prefix": "Show All",
                            "label_value": "261",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Friday&f[shipments.assigned_day_of_week_index]=4&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T01+%5B10.0%2C10.01%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Saturday|FIELD|5": {
                    "value": 24,
                    "links": [
                        {
                            "label": "Show All 24",
                            "label_prefix": "Show All",
                            "label_value": "24",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Saturday&f[shipments.assigned_day_of_week_index]=5&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T01+%5B10.0%2C10.01%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Sunday|FIELD|6": {
                    "value": 21,
                    "links": [
                        {
                            "label": "Show All 21",
                            "label_prefix": "Show All",
                            "label_value": "21",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Sunday&f[shipments.assigned_day_of_week_index]=6&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T01+%5B10.0%2C10.01%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                }
            },
            "percent_of_shipments_count_shipments_2": {
                "Monday|FIELD|0": {
                    "value": 0.17013752455795678,
                    "rendered": "17%"
                },
                "Tuesday|FIELD|1": {
                    "value": 0.14819897084048028,
                    "rendered": "15%"
                },
                "Wednesday|FIELD|2": {
                    "value": 0.13376110562685095,
                    "rendered": "13%"
                },
                "Thursday|FIELD|3": {
                    "value": 0.1329394387001477,
                    "rendered": "13%"
                },
                "Friday|FIELD|4": {
                    "value": 0.14123376623376624,
                    "rendered": "14%"
                },
                "Saturday|FIELD|5": {
                    "value": 0.10572687224669604,
                    "rendered": "11%"
                },
                "Sunday|FIELD|6": {
                    "value": 0.11170212765957446,
                    "rendered": "11%"
                }
            }
        },
        {
            "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
                "value": "T02 [10.01,20.0)",
                "filterable_value": "\"T02 [10.01,20.0)\"",
                "sort_value": "02"
            },
            "shipments.shipment_count": {
                "Monday|FIELD|0": {
                    "value": 183,
                    "links": [
                        {
                            "label": "Show All 183",
                            "label_prefix": "Show All",
                            "label_value": "183",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Monday&f[shipments.assigned_day_of_week_index]=0&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T02+%5B10.01%2C20.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Tuesday|FIELD|1": {
                    "value": 202,
                    "links": [
                        {
                            "label": "Show All 202",
                            "label_prefix": "Show All",
                            "label_value": "202",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Tuesday&f[shipments.assigned_day_of_week_index]=1&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T02+%5B10.01%2C20.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Wednesday|FIELD|2": {
                    "value": 149,
                    "links": [
                        {
                            "label": "Show All 149",
                            "label_prefix": "Show All",
                            "label_value": "149",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Wednesday&f[shipments.assigned_day_of_week_index]=2&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T02+%5B10.01%2C20.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Thursday|FIELD|3": {
                    "value": 168,
                    "links": [
                        {
                            "label": "Show All 168",
                            "label_prefix": "Show All",
                            "label_value": "168",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Thursday&f[shipments.assigned_day_of_week_index]=3&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T02+%5B10.01%2C20.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Friday|FIELD|4": {
                    "value": 144,
                    "links": [
                        {
                            "label": "Show All 144",
                            "label_prefix": "Show All",
                            "label_value": "144",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Friday&f[shipments.assigned_day_of_week_index]=4&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T02+%5B10.01%2C20.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Saturday|FIELD|5": {
                    "value": 18,
                    "links": [
                        {
                            "label": "Show All 18",
                            "label_prefix": "Show All",
                            "label_value": "18",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Saturday&f[shipments.assigned_day_of_week_index]=5&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T02+%5B10.01%2C20.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Sunday|FIELD|6": {
                    "value": 15,
                    "links": [
                        {
                            "label": "Show All 15",
                            "label_prefix": "Show All",
                            "label_value": "15",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Sunday&f[shipments.assigned_day_of_week_index]=6&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T02+%5B10.01%2C20.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                }
            },
            "percent_of_shipments_count_shipments_2": {
                "Monday|FIELD|0": {
                    "value": 0.0719056974459725,
                    "rendered": "7%"
                },
                "Tuesday|FIELD|1": {
                    "value": 0.06929674099485421,
                    "rendered": "7%"
                },
                "Wednesday|FIELD|2": {
                    "value": 0.07354392892398816,
                    "rendered": "7%"
                },
                "Thursday|FIELD|3": {
                    "value": 0.0827178729689808,
                    "rendered": "8%"
                },
                "Friday|FIELD|4": {
                    "value": 0.07792207792207792,
                    "rendered": "8%"
                },
                "Saturday|FIELD|5": {
                    "value": 0.07929515418502203,
                    "rendered": "8%"
                },
                "Sunday|FIELD|6": {
                    "value": 0.0797872340425532,
                    "rendered": "8%"
                }
            }
        },
        {
            "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
                "value": "T03 [20.0,30.0)",
                "filterable_value": "\"T03 [20.0,30.0)\"",
                "sort_value": "03"
            },
            "shipments.shipment_count": {
                "Monday|FIELD|0": {
                    "value": 327,
                    "links": [
                        {
                            "label": "Show All 327",
                            "label_prefix": "Show All",
                            "label_value": "327",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Monday&f[shipments.assigned_day_of_week_index]=0&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T03+%5B20.0%2C30.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Tuesday|FIELD|1": {
                    "value": 386,
                    "links": [
                        {
                            "label": "Show All 386",
                            "label_prefix": "Show All",
                            "label_value": "386",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Tuesday&f[shipments.assigned_day_of_week_index]=1&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T03+%5B20.0%2C30.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Wednesday|FIELD|2": {
                    "value": 277,
                    "links": [
                        {
                            "label": "Show All 277",
                            "label_prefix": "Show All",
                            "label_value": "277",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Wednesday&f[shipments.assigned_day_of_week_index]=2&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T03+%5B20.0%2C30.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Thursday|FIELD|3": {
                    "value": 291,
                    "links": [
                        {
                            "label": "Show All 291",
                            "label_prefix": "Show All",
                            "label_value": "291",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Thursday&f[shipments.assigned_day_of_week_index]=3&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T03+%5B20.0%2C30.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Friday|FIELD|4": {
                    "value": 200,
                    "links": [
                        {
                            "label": "Show All 200",
                            "label_prefix": "Show All",
                            "label_value": "200",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Friday&f[shipments.assigned_day_of_week_index]=4&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T03+%5B20.0%2C30.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Saturday|FIELD|5": {
                    "value": 27,
                    "links": [
                        {
                            "label": "Show All 27",
                            "label_prefix": "Show All",
                            "label_value": "27",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Saturday&f[shipments.assigned_day_of_week_index]=5&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T03+%5B20.0%2C30.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Sunday|FIELD|6": {
                    "value": 28,
                    "links": [
                        {
                            "label": "Show All 28",
                            "label_prefix": "Show All",
                            "label_value": "28",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Sunday&f[shipments.assigned_day_of_week_index]=6&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T03+%5B20.0%2C30.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                }
            },
            "percent_of_shipments_count_shipments_2": {
                "Monday|FIELD|0": {
                    "value": 0.12848722986247543,
                    "rendered": "13%"
                },
                "Tuesday|FIELD|1": {
                    "value": 0.13241852487135505,
                    "rendered": "13%"
                },
                "Wednesday|FIELD|2": {
                    "value": 0.13672260612043435,
                    "rendered": "14%"
                },
                "Thursday|FIELD|3": {
                    "value": 0.1432791728212703,
                    "rendered": "14%"
                },
                "Friday|FIELD|4": {
                    "value": 0.10822510822510822,
                    "rendered": "11%"
                },
                "Saturday|FIELD|5": {
                    "value": 0.11894273127753303,
                    "rendered": "12%"
                },
                "Sunday|FIELD|6": {
                    "value": 0.14893617021276595,
                    "rendered": "15%"
                }
            }
        },
        {
            "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
                "value": "T04 [30.0,40.0)",
                "filterable_value": "\"T04 [30.0,40.0)\"",
                "sort_value": "04"
            },
            "shipments.shipment_count": {
                "Monday|FIELD|0": {
                    "value": 192,
                    "links": [
                        {
                            "label": "Show All 192",
                            "label_prefix": "Show All",
                            "label_value": "192",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Monday&f[shipments.assigned_day_of_week_index]=0&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T04+%5B30.0%2C40.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Tuesday|FIELD|1": {
                    "value": 245,
                    "links": [
                        {
                            "label": "Show All 245",
                            "label_prefix": "Show All",
                            "label_value": "245",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Tuesday&f[shipments.assigned_day_of_week_index]=1&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T04+%5B30.0%2C40.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Wednesday|FIELD|2": {
                    "value": 129,
                    "links": [
                        {
                            "label": "Show All 129",
                            "label_prefix": "Show All",
                            "label_value": "129",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Wednesday&f[shipments.assigned_day_of_week_index]=2&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T04+%5B30.0%2C40.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Thursday|FIELD|3": {
                    "value": 111,
                    "links": [
                        {
                            "label": "Show All 111",
                            "label_prefix": "Show All",
                            "label_value": "111",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Thursday&f[shipments.assigned_day_of_week_index]=3&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T04+%5B30.0%2C40.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Friday|FIELD|4": {
                    "value": 125,
                    "links": [
                        {
                            "label": "Show All 125",
                            "label_prefix": "Show All",
                            "label_value": "125",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Friday&f[shipments.assigned_day_of_week_index]=4&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T04+%5B30.0%2C40.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Saturday|FIELD|5": {
                    "value": 17,
                    "links": [
                        {
                            "label": "Show All 17",
                            "label_prefix": "Show All",
                            "label_value": "17",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Saturday&f[shipments.assigned_day_of_week_index]=5&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T04+%5B30.0%2C40.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Sunday|FIELD|6": {
                    "value": 14,
                    "links": [
                        {
                            "label": "Show All 14",
                            "label_prefix": "Show All",
                            "label_value": "14",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Sunday&f[shipments.assigned_day_of_week_index]=6&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T04+%5B30.0%2C40.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                }
            },
            "percent_of_shipments_count_shipments_2": {
                "Monday|FIELD|0": {
                    "value": 0.07544204322200393,
                    "rendered": "8%"
                },
                "Tuesday|FIELD|1": {
                    "value": 0.08404802744425385,
                    "rendered": "8%"
                },
                "Wednesday|FIELD|2": {
                    "value": 0.06367226061204344,
                    "rendered": "6%"
                },
                "Thursday|FIELD|3": {
                    "value": 0.05465288035450517,
                    "rendered": "5%"
                },
                "Friday|FIELD|4": {
                    "value": 0.06764069264069264,
                    "rendered": "7%"
                },
                "Saturday|FIELD|5": {
                    "value": 0.07488986784140969,
                    "rendered": "7%"
                },
                "Sunday|FIELD|6": {
                    "value": 0.07446808510638298,
                    "rendered": "7%"
                }
            }
        },
        {
            "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
                "value": "T05 [40.0,50.0)",
                "filterable_value": "\"T05 [40.0,50.0)\"",
                "sort_value": "05"
            },
            "shipments.shipment_count": {
                "Monday|FIELD|0": {
                    "value": 155,
                    "links": [
                        {
                            "label": "Show All 155",
                            "label_prefix": "Show All",
                            "label_value": "155",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Monday&f[shipments.assigned_day_of_week_index]=0&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T05+%5B40.0%2C50.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Tuesday|FIELD|1": {
                    "value": 196,
                    "links": [
                        {
                            "label": "Show All 196",
                            "label_prefix": "Show All",
                            "label_value": "196",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Tuesday&f[shipments.assigned_day_of_week_index]=1&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T05+%5B40.0%2C50.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Wednesday|FIELD|2": {
                    "value": 110,
                    "links": [
                        {
                            "label": "Show All 110",
                            "label_prefix": "Show All",
                            "label_value": "110",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Wednesday&f[shipments.assigned_day_of_week_index]=2&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T05+%5B40.0%2C50.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Thursday|FIELD|3": {
                    "value": 140,
                    "links": [
                        {
                            "label": "Show All 140",
                            "label_prefix": "Show All",
                            "label_value": "140",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Thursday&f[shipments.assigned_day_of_week_index]=3&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T05+%5B40.0%2C50.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Friday|FIELD|4": {
                    "value": 107,
                    "links": [
                        {
                            "label": "Show All 107",
                            "label_prefix": "Show All",
                            "label_value": "107",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Friday&f[shipments.assigned_day_of_week_index]=4&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T05+%5B40.0%2C50.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Saturday|FIELD|5": {
                    "value": 6,
                    "links": [
                        {
                            "label": "Show All 6",
                            "label_prefix": "Show All",
                            "label_value": "6",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Saturday&f[shipments.assigned_day_of_week_index]=5&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T05+%5B40.0%2C50.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Sunday|FIELD|6": {
                    "value": 5,
                    "links": [
                        {
                            "label": "Show All 5",
                            "label_prefix": "Show All",
                            "label_value": "5",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Sunday&f[shipments.assigned_day_of_week_index]=6&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T05+%5B40.0%2C50.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                }
            },
            "percent_of_shipments_count_shipments_2": {
                "Monday|FIELD|0": {
                    "value": 0.060903732809430254,
                    "rendered": "6%"
                },
                "Tuesday|FIELD|1": {
                    "value": 0.06723842195540308,
                    "rendered": "7%"
                },
                "Wednesday|FIELD|2": {
                    "value": 0.054294175715695954,
                    "rendered": "5%"
                },
                "Thursday|FIELD|3": {
                    "value": 0.068931560807484,
                    "rendered": "7%"
                },
                "Friday|FIELD|4": {
                    "value": 0.057900432900432904,
                    "rendered": "6%"
                },
                "Saturday|FIELD|5": {
                    "value": 0.02643171806167401,
                    "rendered": "3%"
                },
                "Sunday|FIELD|6": {
                    "value": 0.026595744680851064,
                    "rendered": "3%"
                }
            }
        },
        {
            "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
                "value": "T06 [50.0,60.0)",
                "filterable_value": "\"T06 [50.0,60.0)\"",
                "sort_value": "06"
            },
            "shipments.shipment_count": {
                "Monday|FIELD|0": {
                    "value": 214,
                    "links": [
                        {
                            "label": "Show All 214",
                            "label_prefix": "Show All",
                            "label_value": "214",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Monday&f[shipments.assigned_day_of_week_index]=0&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T06+%5B50.0%2C60.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Tuesday|FIELD|1": {
                    "value": 236,
                    "links": [
                        {
                            "label": "Show All 236",
                            "label_prefix": "Show All",
                            "label_value": "236",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Tuesday&f[shipments.assigned_day_of_week_index]=1&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T06+%5B50.0%2C60.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Wednesday|FIELD|2": {
                    "value": 169,
                    "links": [
                        {
                            "label": "Show All 169",
                            "label_prefix": "Show All",
                            "label_value": "169",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Wednesday&f[shipments.assigned_day_of_week_index]=2&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T06+%5B50.0%2C60.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Thursday|FIELD|3": {
                    "value": 167,
                    "links": [
                        {
                            "label": "Show All 167",
                            "label_prefix": "Show All",
                            "label_value": "167",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Thursday&f[shipments.assigned_day_of_week_index]=3&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T06+%5B50.0%2C60.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Friday|FIELD|4": {
                    "value": 137,
                    "links": [
                        {
                            "label": "Show All 137",
                            "label_prefix": "Show All",
                            "label_value": "137",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Friday&f[shipments.assigned_day_of_week_index]=4&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T06+%5B50.0%2C60.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Saturday|FIELD|5": {
                    "value": 17,
                    "links": [
                        {
                            "label": "Show All 17",
                            "label_prefix": "Show All",
                            "label_value": "17",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Saturday&f[shipments.assigned_day_of_week_index]=5&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T06+%5B50.0%2C60.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Sunday|FIELD|6": {
                    "value": 22,
                    "links": [
                        {
                            "label": "Show All 22",
                            "label_prefix": "Show All",
                            "label_value": "22",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Sunday&f[shipments.assigned_day_of_week_index]=6&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T06+%5B50.0%2C60.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                }
            },
            "percent_of_shipments_count_shipments_2": {
                "Monday|FIELD|0": {
                    "value": 0.08408644400785854,
                    "rendered": "8%"
                },
                "Tuesday|FIELD|1": {
                    "value": 0.08096054888507719,
                    "rendered": "8%"
                },
                "Wednesday|FIELD|2": {
                    "value": 0.08341559723593288,
                    "rendered": "8%"
                },
                "Thursday|FIELD|3": {
                    "value": 0.08222550467749877,
                    "rendered": "8%"
                },
                "Friday|FIELD|4": {
                    "value": 0.07413419913419914,
                    "rendered": "7%"
                },
                "Saturday|FIELD|5": {
                    "value": 0.07488986784140969,
                    "rendered": "7%"
                },
                "Sunday|FIELD|6": {
                    "value": 0.11702127659574468,
                    "rendered": "12%"
                }
            }
        },
        {
            "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
                "value": "T07 [60.0,70.0)",
                "filterable_value": "\"T07 [60.0,70.0)\"",
                "sort_value": "07"
            },
            "shipments.shipment_count": {
                "Monday|FIELD|0": {
                    "value": 195,
                    "links": [
                        {
                            "label": "Show All 195",
                            "label_prefix": "Show All",
                            "label_value": "195",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Monday&f[shipments.assigned_day_of_week_index]=0&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T07+%5B60.0%2C70.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Tuesday|FIELD|1": {
                    "value": 207,
                    "links": [
                        {
                            "label": "Show All 207",
                            "label_prefix": "Show All",
                            "label_value": "207",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Tuesday&f[shipments.assigned_day_of_week_index]=1&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T07+%5B60.0%2C70.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Wednesday|FIELD|2": {
                    "value": 142,
                    "links": [
                        {
                            "label": "Show All 142",
                            "label_prefix": "Show All",
                            "label_value": "142",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Wednesday&f[shipments.assigned_day_of_week_index]=2&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T07+%5B60.0%2C70.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Thursday|FIELD|3": {
                    "value": 132,
                    "links": [
                        {
                            "label": "Show All 132",
                            "label_prefix": "Show All",
                            "label_value": "132",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Thursday&f[shipments.assigned_day_of_week_index]=3&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T07+%5B60.0%2C70.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Friday|FIELD|4": {
                    "value": 154,
                    "links": [
                        {
                            "label": "Show All 154",
                            "label_prefix": "Show All",
                            "label_value": "154",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Friday&f[shipments.assigned_day_of_week_index]=4&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T07+%5B60.0%2C70.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Saturday|FIELD|5": {
                    "value": 23,
                    "links": [
                        {
                            "label": "Show All 23",
                            "label_prefix": "Show All",
                            "label_value": "23",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Saturday&f[shipments.assigned_day_of_week_index]=5&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T07+%5B60.0%2C70.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Sunday|FIELD|6": {
                    "value": 12,
                    "links": [
                        {
                            "label": "Show All 12",
                            "label_prefix": "Show All",
                            "label_value": "12",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Sunday&f[shipments.assigned_day_of_week_index]=6&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T07+%5B60.0%2C70.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                }
            },
            "percent_of_shipments_count_shipments_2": {
                "Monday|FIELD|0": {
                    "value": 0.07662082514734773,
                    "rendered": "8%"
                },
                "Tuesday|FIELD|1": {
                    "value": 0.07101200686106346,
                    "rendered": "7%"
                },
                "Wednesday|FIELD|2": {
                    "value": 0.0700888450148075,
                    "rendered": "7%"
                },
                "Thursday|FIELD|3": {
                    "value": 0.06499261447562776,
                    "rendered": "6%"
                },
                "Friday|FIELD|4": {
                    "value": 0.08333333333333333,
                    "rendered": "8%"
                },
                "Saturday|FIELD|5": {
                    "value": 0.1013215859030837,
                    "rendered": "10%"
                },
                "Sunday|FIELD|6": {
                    "value": 0.06382978723404255,
                    "rendered": "6%"
                }
            }
        },
        {
            "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
                "value": "T08 [70.0,80.0)",
                "filterable_value": "\"T08 [70.0,80.0)\"",
                "sort_value": "08"
            },
            "shipments.shipment_count": {
                "Monday|FIELD|0": {
                    "value": 229,
                    "links": [
                        {
                            "label": "Show All 229",
                            "label_prefix": "Show All",
                            "label_value": "229",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Monday&f[shipments.assigned_day_of_week_index]=0&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T08+%5B70.0%2C80.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Tuesday|FIELD|1": {
                    "value": 315,
                    "links": [
                        {
                            "label": "Show All 315",
                            "label_prefix": "Show All",
                            "label_value": "315",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Tuesday&f[shipments.assigned_day_of_week_index]=1&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T08+%5B70.0%2C80.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Wednesday|FIELD|2": {
                    "value": 202,
                    "links": [
                        {
                            "label": "Show All 202",
                            "label_prefix": "Show All",
                            "label_value": "202",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Wednesday&f[shipments.assigned_day_of_week_index]=2&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T08+%5B70.0%2C80.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Thursday|FIELD|3": {
                    "value": 239,
                    "links": [
                        {
                            "label": "Show All 239",
                            "label_prefix": "Show All",
                            "label_value": "239",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Thursday&f[shipments.assigned_day_of_week_index]=3&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T08+%5B70.0%2C80.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Friday|FIELD|4": {
                    "value": 188,
                    "links": [
                        {
                            "label": "Show All 188",
                            "label_prefix": "Show All",
                            "label_value": "188",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Friday&f[shipments.assigned_day_of_week_index]=4&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T08+%5B70.0%2C80.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Saturday|FIELD|5": {
                    "value": 30,
                    "links": [
                        {
                            "label": "Show All 30",
                            "label_prefix": "Show All",
                            "label_value": "30",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Saturday&f[shipments.assigned_day_of_week_index]=5&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T08+%5B70.0%2C80.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Sunday|FIELD|6": {
                    "value": 12,
                    "links": [
                        {
                            "label": "Show All 12",
                            "label_prefix": "Show All",
                            "label_value": "12",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Sunday&f[shipments.assigned_day_of_week_index]=6&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T08+%5B70.0%2C80.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                }
            },
            "percent_of_shipments_count_shipments_2": {
                "Monday|FIELD|0": {
                    "value": 0.0899803536345776,
                    "rendered": "9%"
                },
                "Tuesday|FIELD|1": {
                    "value": 0.10806174957118353,
                    "rendered": "11%"
                },
                "Wednesday|FIELD|2": {
                    "value": 0.09970384995064166,
                    "rendered": "10%"
                },
                "Thursday|FIELD|3": {
                    "value": 0.11767602166420482,
                    "rendered": "12%"
                },
                "Friday|FIELD|4": {
                    "value": 0.10173160173160173,
                    "rendered": "10%"
                },
                "Saturday|FIELD|5": {
                    "value": 0.13215859030837004,
                    "rendered": "13%"
                },
                "Sunday|FIELD|6": {
                    "value": 0.06382978723404255,
                    "rendered": "6%"
                }
            }
        },
        {
            "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
                "value": "T09 [80.0,90.0)",
                "filterable_value": "\"T09 [80.0,90.0)\"",
                "sort_value": "09"
            },
            "shipments.shipment_count": {
                "Monday|FIELD|0": {
                    "value": 242,
                    "links": [
                        {
                            "label": "Show All 242",
                            "label_prefix": "Show All",
                            "label_value": "242",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Monday&f[shipments.assigned_day_of_week_index]=0&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T09+%5B80.0%2C90.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Tuesday|FIELD|1": {
                    "value": 223,
                    "links": [
                        {
                            "label": "Show All 223",
                            "label_prefix": "Show All",
                            "label_value": "223",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Tuesday&f[shipments.assigned_day_of_week_index]=1&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T09+%5B80.0%2C90.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Wednesday|FIELD|2": {
                    "value": 174,
                    "links": [
                        {
                            "label": "Show All 174",
                            "label_prefix": "Show All",
                            "label_value": "174",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Wednesday&f[shipments.assigned_day_of_week_index]=2&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T09+%5B80.0%2C90.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Thursday|FIELD|3": {
                    "value": 178,
                    "links": [
                        {
                            "label": "Show All 178",
                            "label_prefix": "Show All",
                            "label_value": "178",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Thursday&f[shipments.assigned_day_of_week_index]=3&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T09+%5B80.0%2C90.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Friday|FIELD|4": {
                    "value": 190,
                    "links": [
                        {
                            "label": "Show All 190",
                            "label_prefix": "Show All",
                            "label_value": "190",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Friday&f[shipments.assigned_day_of_week_index]=4&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T09+%5B80.0%2C90.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Saturday|FIELD|5": {
                    "value": 22,
                    "links": [
                        {
                            "label": "Show All 22",
                            "label_prefix": "Show All",
                            "label_value": "22",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Saturday&f[shipments.assigned_day_of_week_index]=5&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T09+%5B80.0%2C90.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Sunday|FIELD|6": {
                    "value": 17,
                    "links": [
                        {
                            "label": "Show All 17",
                            "label_prefix": "Show All",
                            "label_value": "17",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Sunday&f[shipments.assigned_day_of_week_index]=6&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T09+%5B80.0%2C90.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                }
            },
            "percent_of_shipments_count_shipments_2": {
                "Monday|FIELD|0": {
                    "value": 0.09508840864440078,
                    "rendered": "10%"
                },
                "Tuesday|FIELD|1": {
                    "value": 0.0765008576329331,
                    "rendered": "8%"
                },
                "Wednesday|FIELD|2": {
                    "value": 0.08588351431391905,
                    "rendered": "9%"
                },
                "Thursday|FIELD|3": {
                    "value": 0.08764155588380108,
                    "rendered": "9%"
                },
                "Friday|FIELD|4": {
                    "value": 0.10281385281385282,
                    "rendered": "10%"
                },
                "Saturday|FIELD|5": {
                    "value": 0.09691629955947137,
                    "rendered": "10%"
                },
                "Sunday|FIELD|6": {
                    "value": 0.09042553191489362,
                    "rendered": "9%"
                }
            }
        },
        {
            "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
                "value": "T10 [90.0,inf)",
                "filterable_value": "\"T10 [90.0,inf)\"",
                "sort_value": "10"
            },
            "shipments.shipment_count": {
                "Monday|FIELD|0": {
                    "value": 375,
                    "links": [
                        {
                            "label": "Show All 375",
                            "label_prefix": "Show All",
                            "label_value": "375",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Monday&f[shipments.assigned_day_of_week_index]=0&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T10+%5B90.0%2Cinf%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Tuesday|FIELD|1": {
                    "value": 473,
                    "links": [
                        {
                            "label": "Show All 473",
                            "label_prefix": "Show All",
                            "label_value": "473",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Tuesday&f[shipments.assigned_day_of_week_index]=1&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T10+%5B90.0%2Cinf%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Wednesday|FIELD|2": {
                    "value": 403,
                    "links": [
                        {
                            "label": "Show All 403",
                            "label_prefix": "Show All",
                            "label_value": "403",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Wednesday&f[shipments.assigned_day_of_week_index]=2&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T10+%5B90.0%2Cinf%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Thursday|FIELD|3": {
                    "value": 335,
                    "links": [
                        {
                            "label": "Show All 335",
                            "label_prefix": "Show All",
                            "label_value": "335",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Thursday&f[shipments.assigned_day_of_week_index]=3&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T10+%5B90.0%2Cinf%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Friday|FIELD|4": {
                    "value": 342,
                    "links": [
                        {
                            "label": "Show All 342",
                            "label_prefix": "Show All",
                            "label_value": "342",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Friday&f[shipments.assigned_day_of_week_index]=4&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T10+%5B90.0%2Cinf%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Saturday|FIELD|5": {
                    "value": 43,
                    "links": [
                        {
                            "label": "Show All 43",
                            "label_prefix": "Show All",
                            "label_value": "43",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Saturday&f[shipments.assigned_day_of_week_index]=5&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T10+%5B90.0%2Cinf%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                },
                "Sunday|FIELD|6": {
                    "value": 42,
                    "links": [
                        {
                            "label": "Show All 42",
                            "label_prefix": "Show All",
                            "label_value": "42",
                            "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Sunday&f[shipments.assigned_day_of_week_index]=6&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T10+%5B90.0%2Cinf%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                            "type": "measure_default"
                        }
                    ]
                }
            },
            "percent_of_shipments_count_shipments_2": {
                "Monday|FIELD|0": {
                    "value": 0.14734774066797643,
                    "rendered": "15%"
                },
                "Tuesday|FIELD|1": {
                    "value": 0.16226415094339622,
                    "rendered": "16%"
                },
                "Wednesday|FIELD|2": {
                    "value": 0.19891411648568608,
                    "rendered": "20%"
                },
                "Thursday|FIELD|3": {
                    "value": 0.16494337764647957,
                    "rendered": "16%"
                },
                "Friday|FIELD|4": {
                    "value": 0.18506493506493507,
                    "rendered": "19%"
                },
                "Saturday|FIELD|5": {
                    "value": 0.1894273127753304,
                    "rendered": "19%"
                },
                "Sunday|FIELD|6": {
                    "value": 0.22340425531914893,
                    "rendered": "22%"
                }
            }
        }
    ],
    "drill_menu_build_time": 0.047659,
    "expired": false,
    "fields": {
        "measures": [],
        "dimensions": [
            {
                "align": "left",
                "can_filter": true,
                "category": "dimension",
                "default_filter_value": null,
                "description": "",
                "enumerations": [
                    {
                        "label": "T00 (-inf,10.0)",
                        "value": "T00 (-inf,10.0)"
                    },
                    {
                        "label": "T01 [10.0,10.01)",
                        "value": "T01 [10.0,10.01)"
                    },
                    {
                        "label": "T02 [10.01,20.0)",
                        "value": "T02 [10.01,20.0)"
                    },
                    {
                        "label": "T03 [20.0,30.0)",
                        "value": "T03 [20.0,30.0)"
                    },
                    {
                        "label": "T04 [30.0,40.0)",
                        "value": "T04 [30.0,40.0)"
                    },
                    {
                        "label": "T05 [40.0,50.0)",
                        "value": "T05 [40.0,50.0)"
                    },
                    {
                        "label": "T06 [50.0,60.0)",
                        "value": "T06 [50.0,60.0)"
                    },
                    {
                        "label": "T07 [60.0,70.0)",
                        "value": "T07 [60.0,70.0)"
                    },
                    {
                        "label": "T08 [70.0,80.0)",
                        "value": "T08 [70.0,80.0)"
                    },
                    {
                        "label": "T09 [80.0,90.0)",
                        "value": "T09 [80.0,90.0)"
                    },
                    {
                        "label": "T10 [90.0,inf)",
                        "value": "T10 [90.0,inf)"
                    },
                    {
                        "label": "TXX Undefined",
                        "value": "TXX Undefined"
                    }
                ],
                "field_group_label": "Rates as TCM Percentile",
                "fill_style": "enumeration",
                "fiscal_month_offset": 0,
                "has_allowed_values": false,
                "hidden": false,
                "is_filter": false,
                "is_numeric": false,
                "label": "Transfix Cost Predictions Carrier Rate As Tcm Percentile Tier",
                "label_from_parameter": null,
                "label_short": "Carrier Rate As Tcm Percentile Tier",
                "map_layer": null,
                "name": "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier",
                "strict_value_format": false,
                "requires_refresh_on_sort": false,
                "sortable": true,
                "suggestions": [
                    "T00 (-inf,10.0)",
                    "T01 [10.0,10.01)",
                    "T02 [10.01,20.0)",
                    "T03 [20.0,30.0)",
                    "T04 [30.0,40.0)",
                    "T05 [40.0,50.0)",
                    "T06 [50.0,60.0)",
                    "T07 [60.0,70.0)",
                    "T08 [70.0,80.0)",
                    "T09 [80.0,90.0)",
                    "T10 [90.0,inf)",
                    "TXX Undefined"
                ],
                "tags": [],
                "type": "tier",
                "user_attribute_filter_types": [
                    "string",
                    "advanced_filter_string"
                ],
                "value_format": null,
                "view": "shipment_transfix_cost_predictions",
                "view_label": "Transfix Cost Predictions",
                "dynamic": false,
                "week_start_day": "monday",
                "original_view": "shipment_transfix_cost_predictions",
                "dimension_group": null,
                "error": null,
                "field_group_variant": "Carrier Rate As Tcm Percentile Tier",
                "measure": false,
                "parameter": false,
                "primary_key": false,
                "project_name": "snowflake",
                "scope": "shipment_transfix_cost_predictions",
                "suggest_dimension": "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier",
                "suggest_explore": "shipments",
                "suggestable": true,
                "is_fiscal": false,
                "is_timeframe": false,
                "can_time_filter": false,
                "time_interval": null,
                "lookml_link": "/projects/snowflake/files/MarketPlace%2FCore%2Fviews%2Fshipment_transfix_cost_predictions.view.lkml?line=298",
                "permanent": null,
                "source_file": "MarketPlace/Core/views/shipment_transfix_cost_predictions.view.lkml",
                "source_file_path": "snowflake/MarketPlace/Core/views/shipment_transfix_cost_predictions.view.lkml",
                "sql": "round(${carrier_rate_as_tcm_percentile},0) ",
                "sql_case": null,
                "filters": null,
                "times_used": 0,
                "sorted": {
                    "desc": false,
                    "sort_index": 0
                }
            }
        ],
        "table_calculations": [
            {
                "label": "Percent of Shipments Count Shipments",
                "name": "percent_of_shipments_count_shipments_2",
                "expression": "(${shipments.shipment_count} / sum(${shipments.shipment_count}))",
                "can_pivot": true,
                "sortable": true,
                "type": "number",
                "align": "right",
                "measure": true,
                "is_table_calculation": true,
                "dynamic": true,
                "value_format": "#,##0%",
                "is_numeric": true
            }
        ],
        "pivots": [
            {
                "align": "left",
                "can_filter": true,
                "category": "dimension",
                "default_filter_value": null,
                "description": "The time that the current carrier assignment was created",
                "enumerations": [
                    {
                        "label": "Monday",
                        "value": "Monday"
                    },
                    {
                        "label": "Tuesday",
                        "value": "Tuesday"
                    },
                    {
                        "label": "Wednesday",
                        "value": "Wednesday"
                    },
                    {
                        "label": "Thursday",
                        "value": "Thursday"
                    },
                    {
                        "label": "Friday",
                        "value": "Friday"
                    },
                    {
                        "label": "Saturday",
                        "value": "Saturday"
                    },
                    {
                        "label": "Sunday",
                        "value": "Sunday"
                    }
                ],
                "field_group_label": "Timestamps",
                "fill_style": "enumeration",
                "fiscal_month_offset": 0,
                "has_allowed_values": false,
                "hidden": false,
                "is_filter": false,
                "is_numeric": false,
                "label": "Shipments Assigned Day of Week",
                "label_from_parameter": null,
                "label_short": "Assigned Day of Week",
                "map_layer": null,
                "name": "shipments.assigned_day_of_week",
                "strict_value_format": false,
                "requires_refresh_on_sort": false,
                "sortable": true,
                "suggestions": null,
                "tags": [],
                "type": "date_day_of_week",
                "user_attribute_filter_types": [
                    "string",
                    "advanced_filter_string"
                ],
                "value_format": null,
                "view": "shipments",
                "view_label": "Shipments",
                "dynamic": false,
                "week_start_day": "monday",
                "original_view": "shipments",
                "dimension_group": "shipments.assigned",
                "error": null,
                "field_group_variant": "Assigned Day of Week",
                "measure": false,
                "parameter": false,
                "primary_key": false,
                "project_name": "snowflake",
                "scope": "shipments",
                "suggest_dimension": "shipments.assigned_day_of_week",
                "suggest_explore": "shipments",
                "suggestable": true,
                "is_fiscal": false,
                "is_timeframe": false,
                "can_time_filter": false,
                "time_interval": null,
                "lookml_link": "/projects/snowflake/files/MarketPlace%2FCore%2Fviews%2Fshipments.view.lkml?line=834",
                "permanent": null,
                "source_file": "MarketPlace/Core/views/shipments.view.lkml",
                "source_file_path": "snowflake/MarketPlace/Core/views/shipments.view.lkml",
                "sql": "${shipment_current_assignment.created_time}::timestamp_ntz ",
                "sql_case": null,
                "filters": null,
                "times_used": 0,
                "sorted": {
                    "desc": false,
                    "sort_index": 1
                }
            }
        ],
        "measure_like": [
            {
                "label": "Percent of Shipments Count Shipments",
                "name": "percent_of_shipments_count_shipments_2",
                "expression": "(${shipments.shipment_count} / sum(${shipments.shipment_count}))",
                "can_pivot": true,
                "sortable": true,
                "type": "number",
                "align": "right",
                "measure": true,
                "is_table_calculation": true,
                "dynamic": true,
                "value_format": "#,##0%",
                "is_numeric": true
            }
        ],
        "supermeasure_like": [],
        "dimension_like": [
            {
                "align": "left",
                "can_filter": true,
                "category": "dimension",
                "default_filter_value": null,
                "description": "",
                "enumerations": [
                    {
                        "label": "T00 (-inf,10.0)",
                        "value": "T00 (-inf,10.0)"
                    },
                    {
                        "label": "T01 [10.0,10.01)",
                        "value": "T01 [10.0,10.01)"
                    },
                    {
                        "label": "T02 [10.01,20.0)",
                        "value": "T02 [10.01,20.0)"
                    },
                    {
                        "label": "T03 [20.0,30.0)",
                        "value": "T03 [20.0,30.0)"
                    },
                    {
                        "label": "T04 [30.0,40.0)",
                        "value": "T04 [30.0,40.0)"
                    },
                    {
                        "label": "T05 [40.0,50.0)",
                        "value": "T05 [40.0,50.0)"
                    },
                    {
                        "label": "T06 [50.0,60.0)",
                        "value": "T06 [50.0,60.0)"
                    },
                    {
                        "label": "T07 [60.0,70.0)",
                        "value": "T07 [60.0,70.0)"
                    },
                    {
                        "label": "T08 [70.0,80.0)",
                        "value": "T08 [70.0,80.0)"
                    },
                    {
                        "label": "T09 [80.0,90.0)",
                        "value": "T09 [80.0,90.0)"
                    },
                    {
                        "label": "T10 [90.0,inf)",
                        "value": "T10 [90.0,inf)"
                    },
                    {
                        "label": "TXX Undefined",
                        "value": "TXX Undefined"
                    }
                ],
                "field_group_label": "Rates as TCM Percentile",
                "fill_style": "enumeration",
                "fiscal_month_offset": 0,
                "has_allowed_values": false,
                "hidden": false,
                "is_filter": false,
                "is_numeric": false,
                "label": "Transfix Cost Predictions Carrier Rate As Tcm Percentile Tier",
                "label_from_parameter": null,
                "label_short": "Carrier Rate As Tcm Percentile Tier",
                "map_layer": null,
                "name": "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier",
                "strict_value_format": false,
                "requires_refresh_on_sort": false,
                "sortable": true,
                "suggestions": [
                    "T00 (-inf,10.0)",
                    "T01 [10.0,10.01)",
                    "T02 [10.01,20.0)",
                    "T03 [20.0,30.0)",
                    "T04 [30.0,40.0)",
                    "T05 [40.0,50.0)",
                    "T06 [50.0,60.0)",
                    "T07 [60.0,70.0)",
                    "T08 [70.0,80.0)",
                    "T09 [80.0,90.0)",
                    "T10 [90.0,inf)",
                    "TXX Undefined"
                ],
                "tags": [],
                "type": "tier",
                "user_attribute_filter_types": [
                    "string",
                    "advanced_filter_string"
                ],
                "value_format": null,
                "view": "shipment_transfix_cost_predictions",
                "view_label": "Transfix Cost Predictions",
                "dynamic": false,
                "week_start_day": "monday",
                "original_view": "shipment_transfix_cost_predictions",
                "dimension_group": null,
                "error": null,
                "field_group_variant": "Carrier Rate As Tcm Percentile Tier",
                "measure": false,
                "parameter": false,
                "primary_key": false,
                "project_name": "snowflake",
                "scope": "shipment_transfix_cost_predictions",
                "suggest_dimension": "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier",
                "suggest_explore": "shipments",
                "suggestable": true,
                "is_fiscal": false,
                "is_timeframe": false,
                "can_time_filter": false,
                "time_interval": null,
                "lookml_link": "/projects/snowflake/files/MarketPlace%2FCore%2Fviews%2Fshipment_transfix_cost_predictions.view.lkml?line=298",
                "permanent": null,
                "source_file": "MarketPlace/Core/views/shipment_transfix_cost_predictions.view.lkml",
                "source_file_path": "snowflake/MarketPlace/Core/views/shipment_transfix_cost_predictions.view.lkml",
                "sql": "round(${carrier_rate_as_tcm_percentile},0) ",
                "sql_case": null,
                "filters": null,
                "times_used": 0,
                "sorted": {
                    "desc": false,
                    "sort_index": 0
                }
            }
        ]
    },
    "fill_fields": [
        "shipments.assigned_day_of_week"
    ],
    "forecast_result": null,
    "has_row_totals": false,
    "has_totals": false,
    "id": "query-result-7:{\"hidden_points_if_no\":[],\"hidden_fields\":[\"shipments.shipment_count\"]}",
    "null_sort_treatment": "high",
    "number_format": "1,234.56",
    "pivots": [
        {
            "key": "Monday|FIELD|0",
            "data": {
                "shipments.assigned_day_of_week": "Monday"
            },
            "sort_values": {
                "shipments.assigned_day_of_week": 0
            },
            "labels": {
                "shipments.assigned_day_of_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>Monday</a>"
            },
            "is_total": false,
            "metadata": {
                "shipments.assigned_day_of_week": {
                    "value": "Monday",
                    "sort_value": 0
                }
            }
        },
        {
            "key": "Tuesday|FIELD|1",
            "data": {
                "shipments.assigned_day_of_week": "Tuesday"
            },
            "sort_values": {
                "shipments.assigned_day_of_week": 1
            },
            "labels": {
                "shipments.assigned_day_of_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>Tuesday</a>"
            },
            "is_total": false,
            "metadata": {
                "shipments.assigned_day_of_week": {
                    "value": "Tuesday",
                    "sort_value": 1
                }
            }
        },
        {
            "key": "Wednesday|FIELD|2",
            "data": {
                "shipments.assigned_day_of_week": "Wednesday"
            },
            "sort_values": {
                "shipments.assigned_day_of_week": 2
            },
            "labels": {
                "shipments.assigned_day_of_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>Wednesday</a>"
            },
            "is_total": false,
            "metadata": {
                "shipments.assigned_day_of_week": {
                    "value": "Wednesday",
                    "sort_value": 2
                }
            }
        },
        {
            "key": "Thursday|FIELD|3",
            "data": {
                "shipments.assigned_day_of_week": "Thursday"
            },
            "sort_values": {
                "shipments.assigned_day_of_week": 3
            },
            "labels": {
                "shipments.assigned_day_of_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>Thursday</a>"
            },
            "is_total": false,
            "metadata": {
                "shipments.assigned_day_of_week": {
                    "value": "Thursday",
                    "sort_value": 3
                }
            }
        },
        {
            "key": "Friday|FIELD|4",
            "data": {
                "shipments.assigned_day_of_week": "Friday"
            },
            "sort_values": {
                "shipments.assigned_day_of_week": 4
            },
            "labels": {
                "shipments.assigned_day_of_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>Friday</a>"
            },
            "is_total": false,
            "metadata": {
                "shipments.assigned_day_of_week": {
                    "value": "Friday",
                    "sort_value": 4
                }
            }
        },
        {
            "key": "Saturday|FIELD|5",
            "data": {
                "shipments.assigned_day_of_week": "Saturday"
            },
            "sort_values": {
                "shipments.assigned_day_of_week": 5
            },
            "labels": {
                "shipments.assigned_day_of_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>Saturday</a>"
            },
            "is_total": false,
            "metadata": {
                "shipments.assigned_day_of_week": {
                    "value": "Saturday",
                    "sort_value": 5
                }
            }
        },
        {
            "key": "Sunday|FIELD|6",
            "data": {
                "shipments.assigned_day_of_week": "Sunday"
            },
            "sort_values": {
                "shipments.assigned_day_of_week": 6
            },
            "labels": {
                "shipments.assigned_day_of_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>Sunday</a>"
            },
            "is_total": false,
            "metadata": {
                "shipments.assigned_day_of_week": {
                    "value": "Sunday",
                    "sort_value": 6
                }
            }
        }
    ],
    "ran_at": "2023-06-13T21:28:21+00:00",
    "runtime": "94.387",
    "sql": "-- raw sql results do not include filled-in values for 'shipments.assigned_day_of_week'\n\n\n-- use existing shipment_transfix_cost_predictions in LOOKER_SCRATCH.LR$YVJY11686690524483_shipment_transfix_cost_predictions\n-- use existing shipment_current_assignment in LOOKER_SCRATCH.LR$YV0XM1686686865112_shipment_current_assignment\nSELECT * FROM (\nSELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank, RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering, CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell FROM (\nSELECT *, MIN(z___rank) OVER (PARTITION BY \"stcp.carrier_rate_as_tcm_percentile_tier__sort_\",\"stcp.carrier_rate_as_tcm_percentile_tier\") as z___min_rank FROM (\nSELECT *, RANK() OVER (ORDER BY \"stcp.carrier_rate_as_tcm_percentile_tier__sort_\" ASC, z__pivot_col_rank, \"stcp.carrier_rate_as_tcm_percentile_tier\") AS z___rank FROM (\nSELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN \"shipments.assigned_day_of_week_index\" IS NULL THEN 1 ELSE 0 END, \"shipments.assigned_day_of_week_index\", CASE WHEN \"shipments.assigned_day_of_week\" IS NULL THEN 1 ELSE 0 END, \"shipments.assigned_day_of_week\") AS z__pivot_col_rank FROM (\nSELECT\n    (CASE TO_CHAR(CONVERT_TIMEZONE('UTC', 'America/New_York', CAST((TO_CHAR(DATE_TRUNC('second', shipment_current_assignment.created_second ), 'YYYY-MM-DD HH24:MI:SS'))::timestamp_ntz  AS TIMESTAMP_NTZ)), 'DY')\n  WHEN 'Tue' THEN 'Tuesday'\n  WHEN 'Wed' THEN 'Wednesday'\n  WHEN 'Thu' THEN 'Thursday'\n  WHEN 'Sat' THEN 'Saturday'\n  ELSE TO_CHAR(CONVERT_TIMEZONE('UTC', 'America/New_York', CAST((TO_CHAR(DATE_TRUNC('second', shipment_current_assignment.created_second ), 'YYYY-MM-DD HH24:MI:SS'))::timestamp_ntz  AS TIMESTAMP_NTZ)), 'DY') || 'day'\nEND\n) AS \"shipments.assigned_day_of_week\",\n        (MOD(EXTRACT(DOW FROM CONVERT_TIMEZONE('UTC', 'America/New_York', CAST((TO_CHAR(DATE_TRUNC('second', shipment_current_assignment.created_second ), 'YYYY-MM-DD HH24:MI:SS'))::timestamp_ntz  AS TIMESTAMP_NTZ)))::integer - 1 + 7, 7)) AS \"shipments.assigned_day_of_week_index\",\n    (CASE\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 10.0 THEN '00'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 10.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 10.01 THEN '01'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 10.01 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 20.0 THEN '02'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 20.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 30.0 THEN '03'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 30.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 40.0 THEN '04'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 40.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 50.0 THEN '05'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 50.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 60.0 THEN '06'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 60.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 70.0 THEN '07'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 70.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 80.0 THEN '08'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 80.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 90.0 THEN '09'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 90.0 THEN '10'\nELSE '11'\nEND\n) AS \"stcp.carrier_rate_as_tcm_percentile_tier__sort_\",\n    (CASE\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 10.0 THEN 'T00 (-inf,10.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 10.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 10.01 THEN 'T01 [10.0,10.01)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 10.01 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 20.0 THEN 'T02 [10.01,20.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 20.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 30.0 THEN 'T03 [20.0,30.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 30.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 40.0 THEN 'T04 [30.0,40.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 40.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 50.0 THEN 'T05 [40.0,50.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 50.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 60.0 THEN 'T06 [50.0,60.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 60.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 70.0 THEN 'T07 [60.0,70.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 70.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 80.0 THEN 'T08 [70.0,80.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 80.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 90.0 THEN 'T09 [80.0,90.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 90.0 THEN 'T10 [90.0,inf)'\nELSE 'TXX Undefined'\nEND\n) AS \"stcp.carrier_rate_as_tcm_percentile_tier\",\n    COUNT(DISTINCT CASE WHEN (CASE WHEN shipments.is_tonu  THEN 1 ELSE 0 END\n) = 0 THEN shipments.id  ELSE NULL END) AS \"shipments.shipment_count\"\nFROM stark_prod.recreated_tables.shipments  AS shipments\nLEFT JOIN LOOKER_SCRATCH.LR$YVJY11686690524483_shipment_transfix_cost_predictions AS shipment_transfix_cost_predictions ON shipment_transfix_cost_predictions.shipment_id=shipments.id\n          and shipment_transfix_cost_predictions.rank_not_assigned=1\n          and (case when shipment_transfix_cost_predictions.synthetic_rate = 'true' then true else false end) = false\n\nLEFT JOIN LOOKER_SCRATCH.LR$YV0XM1686686865112_shipment_current_assignment AS shipment_current_assignment ON shipment_current_assignment.shipment_id = shipments.id\nWHERE ((( (TO_CHAR(DATE_TRUNC('second', shipment_current_assignment.created_second ), 'YYYY-MM-DD HH24:MI:SS'))::timestamp_ntz  ) >= ((CONVERT_TIMEZONE('America/New_York', 'UTC', CAST(DATEADD('day', -21, DATE_TRUNC('week', DATE_TRUNC('day', CONVERT_TIMEZONE('UTC', 'America/New_York', CAST(CURRENT_TIMESTAMP() AS TIMESTAMP_NTZ))))) AS TIMESTAMP_NTZ)))) AND ( (TO_CHAR(DATE_TRUNC('second', shipment_current_assignment.created_second ), 'YYYY-MM-DD HH24:MI:SS'))::timestamp_ntz  ) < ((CONVERT_TIMEZONE('America/New_York', 'UTC', CAST(DATEADD('day', 28, DATEADD('day', -21, DATE_TRUNC('week', DATE_TRUNC('day', CONVERT_TIMEZONE('UTC', 'America/New_York', CAST(CURRENT_TIMESTAMP() AS TIMESTAMP_NTZ)))))) AS TIMESTAMP_NTZ)))))) AND ((shipments.state not in ('canceled','e_submitted') and shipments.is_tonu!='true' and shipments.shipper_application_id not in (625, 1798)) and ((TO_CHAR(DATE_TRUNC('second', shipment_current_assignment.created_second ), 'YYYY-MM-DD HH24:MI:SS')) is not null\n      and shipments.carrier_application_id is not null\n      and shipments.state not in ('offered','waterfall_offered'))) AND ((( (CASE\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 10.0 THEN 'T00 (-inf,10.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 10.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 10.01 THEN 'T01 [10.0,10.01)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 10.01 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 20.0 THEN 'T02 [10.01,20.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 20.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 30.0 THEN 'T03 [20.0,30.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 30.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 40.0 THEN 'T04 [30.0,40.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 40.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 50.0 THEN 'T05 [40.0,50.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 50.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 60.0 THEN 'T06 [50.0,60.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 60.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 70.0 THEN 'T07 [60.0,70.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 70.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 80.0 THEN 'T08 [70.0,80.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 80.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 90.0 THEN 'T09 [80.0,90.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 90.0 THEN 'T10 [90.0,inf)'\nELSE 'TXX Undefined'\nEND\n) ) <> 'T00 (-inf,10.0)' OR ( (CASE\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 10.0 THEN 'T00 (-inf,10.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 10.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 10.01 THEN 'T01 [10.0,10.01)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 10.01 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 20.0 THEN 'T02 [10.01,20.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 20.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 30.0 THEN 'T03 [20.0,30.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 30.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 40.0 THEN 'T04 [30.0,40.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 40.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 50.0 THEN 'T05 [40.0,50.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 50.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 60.0 THEN 'T06 [50.0,60.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 60.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 70.0 THEN 'T07 [60.0,70.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 70.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 80.0 THEN 'T08 [70.0,80.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 80.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 90.0 THEN 'T09 [80.0,90.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 90.0 THEN 'T10 [90.0,inf)'\nELSE 'TXX Undefined'\nEND\n) ) IS NULL))\nGROUP BY\n    1,\n    2,\n    3,\n    4) ww\n) bb WHERE z__pivot_col_rank <= 16384\n) aa\n) xx\n) zz\n WHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1) ORDER BY z___pivot_row_rank",
    "sql_explain": "EXPLAIN SELECT * FROM (\nSELECT *, DENSE_RANK() OVER (ORDER BY z___min_rank) as z___pivot_row_rank, RANK() OVER (PARTITION BY z__pivot_col_rank ORDER BY z___min_rank) as z__pivot_col_ordering, CASE WHEN z___min_rank = z___rank THEN 1 ELSE 0 END AS z__is_highest_ranked_cell FROM (\nSELECT *, MIN(z___rank) OVER (PARTITION BY \"stcp.carrier_rate_as_tcm_percentile_tier__sort_\",\"stcp.carrier_rate_as_tcm_percentile_tier\") as z___min_rank FROM (\nSELECT *, RANK() OVER (ORDER BY \"stcp.carrier_rate_as_tcm_percentile_tier__sort_\" ASC, z__pivot_col_rank, \"stcp.carrier_rate_as_tcm_percentile_tier\") AS z___rank FROM (\nSELECT *, DENSE_RANK() OVER (ORDER BY CASE WHEN \"shipments.assigned_day_of_week_index\" IS NULL THEN 1 ELSE 0 END, \"shipments.assigned_day_of_week_index\", CASE WHEN \"shipments.assigned_day_of_week\" IS NULL THEN 1 ELSE 0 END, \"shipments.assigned_day_of_week\") AS z__pivot_col_rank FROM (\nSELECT\n    (CASE TO_CHAR(CONVERT_TIMEZONE('UTC', 'America/New_York', CAST((TO_CHAR(DATE_TRUNC('second', shipment_current_assignment.created_second ), 'YYYY-MM-DD HH24:MI:SS'))::timestamp_ntz  AS TIMESTAMP_NTZ)), 'DY')\n  WHEN 'Tue' THEN 'Tuesday'\n  WHEN 'Wed' THEN 'Wednesday'\n  WHEN 'Thu' THEN 'Thursday'\n  WHEN 'Sat' THEN 'Saturday'\n  ELSE TO_CHAR(CONVERT_TIMEZONE('UTC', 'America/New_York', CAST((TO_CHAR(DATE_TRUNC('second', shipment_current_assignment.created_second ), 'YYYY-MM-DD HH24:MI:SS'))::timestamp_ntz  AS TIMESTAMP_NTZ)), 'DY') || 'day'\nEND\n) AS \"shipments.assigned_day_of_week\",\n        (MOD(EXTRACT(DOW FROM CONVERT_TIMEZONE('UTC', 'America/New_York', CAST((TO_CHAR(DATE_TRUNC('second', shipment_current_assignment.created_second ), 'YYYY-MM-DD HH24:MI:SS'))::timestamp_ntz  AS TIMESTAMP_NTZ)))::integer - 1 + 7, 7)) AS \"shipments.assigned_day_of_week_index\",\n    (CASE\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 10.0 THEN '00'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 10.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 10.01 THEN '01'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 10.01 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 20.0 THEN '02'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 20.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 30.0 THEN '03'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 30.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 40.0 THEN '04'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 40.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 50.0 THEN '05'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 50.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 60.0 THEN '06'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 60.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 70.0 THEN '07'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 70.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 80.0 THEN '08'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 80.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 90.0 THEN '09'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 90.0 THEN '10'\nELSE '11'\nEND\n) AS \"stcp.carrier_rate_as_tcm_percentile_tier__sort_\",\n    (CASE\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 10.0 THEN 'T00 (-inf,10.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 10.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 10.01 THEN 'T01 [10.0,10.01)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 10.01 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 20.0 THEN 'T02 [10.01,20.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 20.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 30.0 THEN 'T03 [20.0,30.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 30.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 40.0 THEN 'T04 [30.0,40.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 40.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 50.0 THEN 'T05 [40.0,50.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 50.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 60.0 THEN 'T06 [50.0,60.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 60.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 70.0 THEN 'T07 [60.0,70.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 70.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 80.0 THEN 'T08 [70.0,80.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 80.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 90.0 THEN 'T09 [80.0,90.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 90.0 THEN 'T10 [90.0,inf)'\nELSE 'TXX Undefined'\nEND\n) AS \"stcp.carrier_rate_as_tcm_percentile_tier\",\n    COUNT(DISTINCT CASE WHEN (CASE WHEN shipments.is_tonu  THEN 1 ELSE 0 END\n) = 0 THEN shipments.id  ELSE NULL END) AS \"shipments.shipment_count\"\nFROM stark_prod.recreated_tables.shipments  AS shipments\nLEFT JOIN LOOKER_SCRATCH.LR$YVJY11686690524483_shipment_transfix_cost_predictions AS shipment_transfix_cost_predictions ON shipment_transfix_cost_predictions.shipment_id=shipments.id\n          and shipment_transfix_cost_predictions.rank_not_assigned=1\n          and (case when shipment_transfix_cost_predictions.synthetic_rate = 'true' then true else false end) = false\n          \nLEFT JOIN LOOKER_SCRATCH.LR$YV0XM1686686865112_shipment_current_assignment AS shipment_current_assignment ON shipment_current_assignment.shipment_id = shipments.id\nWHERE ((( (TO_CHAR(DATE_TRUNC('second', shipment_current_assignment.created_second ), 'YYYY-MM-DD HH24:MI:SS'))::timestamp_ntz  ) >= ((CONVERT_TIMEZONE('America/New_York', 'UTC', CAST(DATEADD('day', -21, DATE_TRUNC('week', DATE_TRUNC('day', CONVERT_TIMEZONE('UTC', 'America/New_York', CAST(CURRENT_TIMESTAMP() AS TIMESTAMP_NTZ))))) AS TIMESTAMP_NTZ)))) AND ( (TO_CHAR(DATE_TRUNC('second', shipment_current_assignment.created_second ), 'YYYY-MM-DD HH24:MI:SS'))::timestamp_ntz  ) < ((CONVERT_TIMEZONE('America/New_York', 'UTC', CAST(DATEADD('day', 28, DATEADD('day', -21, DATE_TRUNC('week', DATE_TRUNC('day', CONVERT_TIMEZONE('UTC', 'America/New_York', CAST(CURRENT_TIMESTAMP() AS TIMESTAMP_NTZ)))))) AS TIMESTAMP_NTZ)))))) AND ((shipments.state not in ('canceled','e_submitted') and shipments.is_tonu!='true' and shipments.shipper_application_id not in (625, 1798)) and ((TO_CHAR(DATE_TRUNC('second', shipment_current_assignment.created_second ), 'YYYY-MM-DD HH24:MI:SS')) is not null\n      and shipments.carrier_application_id is not null\n      and shipments.state not in ('offered','waterfall_offered'))) AND ((( (CASE\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 10.0 THEN 'T00 (-inf,10.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 10.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 10.01 THEN 'T01 [10.0,10.01)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 10.01 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 20.0 THEN 'T02 [10.01,20.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 20.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 30.0 THEN 'T03 [20.0,30.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 30.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 40.0 THEN 'T04 [30.0,40.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 40.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 50.0 THEN 'T05 [40.0,50.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 50.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 60.0 THEN 'T06 [50.0,60.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 60.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 70.0 THEN 'T07 [60.0,70.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 70.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 80.0 THEN 'T08 [70.0,80.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 80.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 90.0 THEN 'T09 [80.0,90.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 90.0 THEN 'T10 [90.0,inf)'\nELSE 'TXX Undefined'\nEND\n) ) <> 'T00 (-inf,10.0)' OR ( (CASE\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 10.0 THEN 'T00 (-inf,10.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 10.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 10.01 THEN 'T01 [10.0,10.01)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 10.01 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 20.0 THEN 'T02 [10.01,20.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 20.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 30.0 THEN 'T03 [20.0,30.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 30.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 40.0 THEN 'T04 [30.0,40.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 40.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 50.0 THEN 'T05 [40.0,50.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 50.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 60.0 THEN 'T06 [50.0,60.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 60.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 70.0 THEN 'T07 [60.0,70.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 70.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 80.0 THEN 'T08 [70.0,80.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 80.0 AND round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  < 90.0 THEN 'T09 [80.0,90.0)'\nWHEN round((round(CASE WHEN shipment_transfix_cost_predictions.prediction_10 is null\n              -- when we only have TCM25/50/75 need to interpolate differently than when we have TCM10/25/50/75/90\n              THEN (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_bottom THEN 25.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      ELSE 75.0\n                  END)\n              ELSE (CASE WHEN  (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) < shipment_transfix_cost_predictions.prediction_10 THEN 10.0\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_10 and shipment_transfix_cost_predictions.prediction_bottom THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_10)/(shipment_transfix_cost_predictions.prediction_bottom - shipment_transfix_cost_predictions.prediction_10)*(25-10)+10\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_bottom and shipment_transfix_cost_predictions.prediction_estimate THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_bottom)/(shipment_transfix_cost_predictions.prediction_estimate - shipment_transfix_cost_predictions.prediction_bottom)*(50-25)+25\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_estimate and shipment_transfix_cost_predictions.prediction_top THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_estimate)/(shipment_transfix_cost_predictions.prediction_top - shipment_transfix_cost_predictions.prediction_estimate)*(75-50)+50\n                      WHEN (iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) between shipment_transfix_cost_predictions.prediction_top and shipment_transfix_cost_predictions.prediction_90 THEN ((iff(shipments.is_tonu, null, shipments.carrier_rate + (iff(shipments.is_tonu, 0, coalesce(shipments.carrier_total_fuel_surcharge, (coalesce(case when shipments.is_tonu then null else shipments.carrier_per_mile_fuel_rate end,0))*coalesce(shipments.shipper_miles,shipments.calculated_miles)))))) - shipment_transfix_cost_predictions.prediction_top)/(shipment_transfix_cost_predictions.prediction_90 - shipment_transfix_cost_predictions.prediction_top)*(90-75)+75\n                      ELSE 90.0\n                  END)\n          END,0)\n),0)  >= 90.0 THEN 'T10 [90.0,inf)'\nELSE 'TXX Undefined'\nEND\n) ) IS NULL))\nGROUP BY\n    1,\n    2,\n    3,\n    4) ww\n) bb WHERE z__pivot_col_rank <= 16384\n) aa\n) xx\n) zz\n WHERE (z__pivot_col_rank <= 50 OR z__is_highest_ranked_cell = 1) AND (z___pivot_row_rank <= 500 OR z__pivot_col_ordering = 1) ORDER BY z___pivot_row_rank",
    "supports_pivot_in_db": true,
    "timezone": "America/New_York",
    "is_local": true,
    "table_calcs_complete": true,
    "tracked_attributes": {
        "result.drill_menu_build_time": 0.047659,
        "result.from_cache": false,
        "result.runtime": "94.387",
        "result.sql.length": 533746,
        "result.supports_pivot_in_db": true
    },
    "pivotTableColumns": [
        [
            {
                "key": "Monday|FIELD|0",
                "data": {
                    "shipments.assigned_day_of_week": "Monday"
                },
                "sort_values": {
                    "shipments.assigned_day_of_week": 0
                },
                "labels": {
                    "shipments.assigned_day_of_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>Monday</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_day_of_week": {
                        "value": "Monday",
                        "sort_value": 0
                    }
                }
            },
            {
                "align": "right",
                "can_filter": true,
                "category": "measure",
                "default_filter_value": null,
                "description": "Count Unique Shipment ID. Does not Include TONUs",
                "enumerations": null,
                "field_group_label": "Counts",
                "fill_style": null,
                "fiscal_month_offset": 0,
                "has_allowed_values": false,
                "hidden": false,
                "is_filter": false,
                "is_numeric": true,
                "label": "Shipments Count Shipments",
                "label_from_parameter": null,
                "label_short": "Count Shipments",
                "map_layer": null,
                "name": "shipments.shipment_count",
                "strict_value_format": false,
                "requires_refresh_on_sort": false,
                "sortable": true,
                "suggestions": null,
                "tags": [],
                "type": "count_distinct",
                "user_attribute_filter_types": [
                    "number",
                    "advanced_filter_number"
                ],
                "value_format": null,
                "view": "shipments",
                "view_label": "Shipments",
                "dynamic": false,
                "week_start_day": "monday",
                "original_view": "shipments",
                "dimension_group": null,
                "error": null,
                "field_group_variant": "Count Shipments",
                "measure": true,
                "parameter": false,
                "primary_key": false,
                "project_name": "snowflake",
                "scope": "shipments",
                "suggest_dimension": "shipments.shipment_count",
                "suggest_explore": "shipments",
                "suggestable": false,
                "is_fiscal": false,
                "is_timeframe": false,
                "can_time_filter": false,
                "time_interval": null,
                "lookml_link": "/projects/snowflake/files/MarketPlace%2FCore%2Fviews%2Fshipments.view.lkml?line=2764",
                "permanent": null,
                "source_file": "MarketPlace/Core/views/shipments.view.lkml",
                "source_file_path": "snowflake/MarketPlace/Core/views/shipments.view.lkml",
                "sql": "${id} ",
                "sql_case": null,
                "filters": [
                    {
                        "field": "shipments.is_tonu",
                        "condition": "No"
                    }
                ],
                "times_used": 0
            }
        ],
        [
            {
                "key": "Monday|FIELD|0",
                "data": {
                    "shipments.assigned_day_of_week": "Monday"
                },
                "sort_values": {
                    "shipments.assigned_day_of_week": 0
                },
                "labels": {
                    "shipments.assigned_day_of_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>Monday</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_day_of_week": {
                        "value": "Monday",
                        "sort_value": 0
                    }
                }
            },
            {
                "label": "Percent of Shipments Count Shipments",
                "name": "percent_of_shipments_count_shipments_2",
                "expression": "(${shipments.shipment_count} / sum(${shipments.shipment_count}))",
                "can_pivot": true,
                "sortable": true,
                "type": "number",
                "align": "right",
                "measure": true,
                "is_table_calculation": true,
                "dynamic": true,
                "value_format": "#,##0%",
                "is_numeric": true
            }
        ],
        [
            {
                "key": "Tuesday|FIELD|1",
                "data": {
                    "shipments.assigned_day_of_week": "Tuesday"
                },
                "sort_values": {
                    "shipments.assigned_day_of_week": 1
                },
                "labels": {
                    "shipments.assigned_day_of_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>Tuesday</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_day_of_week": {
                        "value": "Tuesday",
                        "sort_value": 1
                    }
                }
            },
            {
                "align": "right",
                "can_filter": true,
                "category": "measure",
                "default_filter_value": null,
                "description": "Count Unique Shipment ID. Does not Include TONUs",
                "enumerations": null,
                "field_group_label": "Counts",
                "fill_style": null,
                "fiscal_month_offset": 0,
                "has_allowed_values": false,
                "hidden": false,
                "is_filter": false,
                "is_numeric": true,
                "label": "Shipments Count Shipments",
                "label_from_parameter": null,
                "label_short": "Count Shipments",
                "map_layer": null,
                "name": "shipments.shipment_count",
                "strict_value_format": false,
                "requires_refresh_on_sort": false,
                "sortable": true,
                "suggestions": null,
                "tags": [],
                "type": "count_distinct",
                "user_attribute_filter_types": [
                    "number",
                    "advanced_filter_number"
                ],
                "value_format": null,
                "view": "shipments",
                "view_label": "Shipments",
                "dynamic": false,
                "week_start_day": "monday",
                "original_view": "shipments",
                "dimension_group": null,
                "error": null,
                "field_group_variant": "Count Shipments",
                "measure": true,
                "parameter": false,
                "primary_key": false,
                "project_name": "snowflake",
                "scope": "shipments",
                "suggest_dimension": "shipments.shipment_count",
                "suggest_explore": "shipments",
                "suggestable": false,
                "is_fiscal": false,
                "is_timeframe": false,
                "can_time_filter": false,
                "time_interval": null,
                "lookml_link": "/projects/snowflake/files/MarketPlace%2FCore%2Fviews%2Fshipments.view.lkml?line=2764",
                "permanent": null,
                "source_file": "MarketPlace/Core/views/shipments.view.lkml",
                "source_file_path": "snowflake/MarketPlace/Core/views/shipments.view.lkml",
                "sql": "${id} ",
                "sql_case": null,
                "filters": [
                    {
                        "field": "shipments.is_tonu",
                        "condition": "No"
                    }
                ],
                "times_used": 0
            }
        ],
        [
            {
                "key": "Tuesday|FIELD|1",
                "data": {
                    "shipments.assigned_day_of_week": "Tuesday"
                },
                "sort_values": {
                    "shipments.assigned_day_of_week": 1
                },
                "labels": {
                    "shipments.assigned_day_of_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>Tuesday</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_day_of_week": {
                        "value": "Tuesday",
                        "sort_value": 1
                    }
                }
            },
            {
                "label": "Percent of Shipments Count Shipments",
                "name": "percent_of_shipments_count_shipments_2",
                "expression": "(${shipments.shipment_count} / sum(${shipments.shipment_count}))",
                "can_pivot": true,
                "sortable": true,
                "type": "number",
                "align": "right",
                "measure": true,
                "is_table_calculation": true,
                "dynamic": true,
                "value_format": "#,##0%",
                "is_numeric": true
            }
        ],
        [
            {
                "key": "Wednesday|FIELD|2",
                "data": {
                    "shipments.assigned_day_of_week": "Wednesday"
                },
                "sort_values": {
                    "shipments.assigned_day_of_week": 2
                },
                "labels": {
                    "shipments.assigned_day_of_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>Wednesday</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_day_of_week": {
                        "value": "Wednesday",
                        "sort_value": 2
                    }
                }
            },
            {
                "align": "right",
                "can_filter": true,
                "category": "measure",
                "default_filter_value": null,
                "description": "Count Unique Shipment ID. Does not Include TONUs",
                "enumerations": null,
                "field_group_label": "Counts",
                "fill_style": null,
                "fiscal_month_offset": 0,
                "has_allowed_values": false,
                "hidden": false,
                "is_filter": false,
                "is_numeric": true,
                "label": "Shipments Count Shipments",
                "label_from_parameter": null,
                "label_short": "Count Shipments",
                "map_layer": null,
                "name": "shipments.shipment_count",
                "strict_value_format": false,
                "requires_refresh_on_sort": false,
                "sortable": true,
                "suggestions": null,
                "tags": [],
                "type": "count_distinct",
                "user_attribute_filter_types": [
                    "number",
                    "advanced_filter_number"
                ],
                "value_format": null,
                "view": "shipments",
                "view_label": "Shipments",
                "dynamic": false,
                "week_start_day": "monday",
                "original_view": "shipments",
                "dimension_group": null,
                "error": null,
                "field_group_variant": "Count Shipments",
                "measure": true,
                "parameter": false,
                "primary_key": false,
                "project_name": "snowflake",
                "scope": "shipments",
                "suggest_dimension": "shipments.shipment_count",
                "suggest_explore": "shipments",
                "suggestable": false,
                "is_fiscal": false,
                "is_timeframe": false,
                "can_time_filter": false,
                "time_interval": null,
                "lookml_link": "/projects/snowflake/files/MarketPlace%2FCore%2Fviews%2Fshipments.view.lkml?line=2764",
                "permanent": null,
                "source_file": "MarketPlace/Core/views/shipments.view.lkml",
                "source_file_path": "snowflake/MarketPlace/Core/views/shipments.view.lkml",
                "sql": "${id} ",
                "sql_case": null,
                "filters": [
                    {
                        "field": "shipments.is_tonu",
                        "condition": "No"
                    }
                ],
                "times_used": 0
            }
        ],
        [
            {
                "key": "Wednesday|FIELD|2",
                "data": {
                    "shipments.assigned_day_of_week": "Wednesday"
                },
                "sort_values": {
                    "shipments.assigned_day_of_week": 2
                },
                "labels": {
                    "shipments.assigned_day_of_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>Wednesday</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_day_of_week": {
                        "value": "Wednesday",
                        "sort_value": 2
                    }
                }
            },
            {
                "label": "Percent of Shipments Count Shipments",
                "name": "percent_of_shipments_count_shipments_2",
                "expression": "(${shipments.shipment_count} / sum(${shipments.shipment_count}))",
                "can_pivot": true,
                "sortable": true,
                "type": "number",
                "align": "right",
                "measure": true,
                "is_table_calculation": true,
                "dynamic": true,
                "value_format": "#,##0%",
                "is_numeric": true
            }
        ],
        [
            {
                "key": "Thursday|FIELD|3",
                "data": {
                    "shipments.assigned_day_of_week": "Thursday"
                },
                "sort_values": {
                    "shipments.assigned_day_of_week": 3
                },
                "labels": {
                    "shipments.assigned_day_of_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>Thursday</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_day_of_week": {
                        "value": "Thursday",
                        "sort_value": 3
                    }
                }
            },
            {
                "align": "right",
                "can_filter": true,
                "category": "measure",
                "default_filter_value": null,
                "description": "Count Unique Shipment ID. Does not Include TONUs",
                "enumerations": null,
                "field_group_label": "Counts",
                "fill_style": null,
                "fiscal_month_offset": 0,
                "has_allowed_values": false,
                "hidden": false,
                "is_filter": false,
                "is_numeric": true,
                "label": "Shipments Count Shipments",
                "label_from_parameter": null,
                "label_short": "Count Shipments",
                "map_layer": null,
                "name": "shipments.shipment_count",
                "strict_value_format": false,
                "requires_refresh_on_sort": false,
                "sortable": true,
                "suggestions": null,
                "tags": [],
                "type": "count_distinct",
                "user_attribute_filter_types": [
                    "number",
                    "advanced_filter_number"
                ],
                "value_format": null,
                "view": "shipments",
                "view_label": "Shipments",
                "dynamic": false,
                "week_start_day": "monday",
                "original_view": "shipments",
                "dimension_group": null,
                "error": null,
                "field_group_variant": "Count Shipments",
                "measure": true,
                "parameter": false,
                "primary_key": false,
                "project_name": "snowflake",
                "scope": "shipments",
                "suggest_dimension": "shipments.shipment_count",
                "suggest_explore": "shipments",
                "suggestable": false,
                "is_fiscal": false,
                "is_timeframe": false,
                "can_time_filter": false,
                "time_interval": null,
                "lookml_link": "/projects/snowflake/files/MarketPlace%2FCore%2Fviews%2Fshipments.view.lkml?line=2764",
                "permanent": null,
                "source_file": "MarketPlace/Core/views/shipments.view.lkml",
                "source_file_path": "snowflake/MarketPlace/Core/views/shipments.view.lkml",
                "sql": "${id} ",
                "sql_case": null,
                "filters": [
                    {
                        "field": "shipments.is_tonu",
                        "condition": "No"
                    }
                ],
                "times_used": 0
            }
        ],
        [
            {
                "key": "Thursday|FIELD|3",
                "data": {
                    "shipments.assigned_day_of_week": "Thursday"
                },
                "sort_values": {
                    "shipments.assigned_day_of_week": 3
                },
                "labels": {
                    "shipments.assigned_day_of_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>Thursday</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_day_of_week": {
                        "value": "Thursday",
                        "sort_value": 3
                    }
                }
            },
            {
                "label": "Percent of Shipments Count Shipments",
                "name": "percent_of_shipments_count_shipments_2",
                "expression": "(${shipments.shipment_count} / sum(${shipments.shipment_count}))",
                "can_pivot": true,
                "sortable": true,
                "type": "number",
                "align": "right",
                "measure": true,
                "is_table_calculation": true,
                "dynamic": true,
                "value_format": "#,##0%",
                "is_numeric": true
            }
        ],
        [
            {
                "key": "Friday|FIELD|4",
                "data": {
                    "shipments.assigned_day_of_week": "Friday"
                },
                "sort_values": {
                    "shipments.assigned_day_of_week": 4
                },
                "labels": {
                    "shipments.assigned_day_of_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>Friday</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_day_of_week": {
                        "value": "Friday",
                        "sort_value": 4
                    }
                }
            },
            {
                "align": "right",
                "can_filter": true,
                "category": "measure",
                "default_filter_value": null,
                "description": "Count Unique Shipment ID. Does not Include TONUs",
                "enumerations": null,
                "field_group_label": "Counts",
                "fill_style": null,
                "fiscal_month_offset": 0,
                "has_allowed_values": false,
                "hidden": false,
                "is_filter": false,
                "is_numeric": true,
                "label": "Shipments Count Shipments",
                "label_from_parameter": null,
                "label_short": "Count Shipments",
                "map_layer": null,
                "name": "shipments.shipment_count",
                "strict_value_format": false,
                "requires_refresh_on_sort": false,
                "sortable": true,
                "suggestions": null,
                "tags": [],
                "type": "count_distinct",
                "user_attribute_filter_types": [
                    "number",
                    "advanced_filter_number"
                ],
                "value_format": null,
                "view": "shipments",
                "view_label": "Shipments",
                "dynamic": false,
                "week_start_day": "monday",
                "original_view": "shipments",
                "dimension_group": null,
                "error": null,
                "field_group_variant": "Count Shipments",
                "measure": true,
                "parameter": false,
                "primary_key": false,
                "project_name": "snowflake",
                "scope": "shipments",
                "suggest_dimension": "shipments.shipment_count",
                "suggest_explore": "shipments",
                "suggestable": false,
                "is_fiscal": false,
                "is_timeframe": false,
                "can_time_filter": false,
                "time_interval": null,
                "lookml_link": "/projects/snowflake/files/MarketPlace%2FCore%2Fviews%2Fshipments.view.lkml?line=2764",
                "permanent": null,
                "source_file": "MarketPlace/Core/views/shipments.view.lkml",
                "source_file_path": "snowflake/MarketPlace/Core/views/shipments.view.lkml",
                "sql": "${id} ",
                "sql_case": null,
                "filters": [
                    {
                        "field": "shipments.is_tonu",
                        "condition": "No"
                    }
                ],
                "times_used": 0
            }
        ],
        [
            {
                "key": "Friday|FIELD|4",
                "data": {
                    "shipments.assigned_day_of_week": "Friday"
                },
                "sort_values": {
                    "shipments.assigned_day_of_week": 4
                },
                "labels": {
                    "shipments.assigned_day_of_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>Friday</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_day_of_week": {
                        "value": "Friday",
                        "sort_value": 4
                    }
                }
            },
            {
                "label": "Percent of Shipments Count Shipments",
                "name": "percent_of_shipments_count_shipments_2",
                "expression": "(${shipments.shipment_count} / sum(${shipments.shipment_count}))",
                "can_pivot": true,
                "sortable": true,
                "type": "number",
                "align": "right",
                "measure": true,
                "is_table_calculation": true,
                "dynamic": true,
                "value_format": "#,##0%",
                "is_numeric": true
            }
        ],
        [
            {
                "key": "Saturday|FIELD|5",
                "data": {
                    "shipments.assigned_day_of_week": "Saturday"
                },
                "sort_values": {
                    "shipments.assigned_day_of_week": 5
                },
                "labels": {
                    "shipments.assigned_day_of_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>Saturday</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_day_of_week": {
                        "value": "Saturday",
                        "sort_value": 5
                    }
                }
            },
            {
                "align": "right",
                "can_filter": true,
                "category": "measure",
                "default_filter_value": null,
                "description": "Count Unique Shipment ID. Does not Include TONUs",
                "enumerations": null,
                "field_group_label": "Counts",
                "fill_style": null,
                "fiscal_month_offset": 0,
                "has_allowed_values": false,
                "hidden": false,
                "is_filter": false,
                "is_numeric": true,
                "label": "Shipments Count Shipments",
                "label_from_parameter": null,
                "label_short": "Count Shipments",
                "map_layer": null,
                "name": "shipments.shipment_count",
                "strict_value_format": false,
                "requires_refresh_on_sort": false,
                "sortable": true,
                "suggestions": null,
                "tags": [],
                "type": "count_distinct",
                "user_attribute_filter_types": [
                    "number",
                    "advanced_filter_number"
                ],
                "value_format": null,
                "view": "shipments",
                "view_label": "Shipments",
                "dynamic": false,
                "week_start_day": "monday",
                "original_view": "shipments",
                "dimension_group": null,
                "error": null,
                "field_group_variant": "Count Shipments",
                "measure": true,
                "parameter": false,
                "primary_key": false,
                "project_name": "snowflake",
                "scope": "shipments",
                "suggest_dimension": "shipments.shipment_count",
                "suggest_explore": "shipments",
                "suggestable": false,
                "is_fiscal": false,
                "is_timeframe": false,
                "can_time_filter": false,
                "time_interval": null,
                "lookml_link": "/projects/snowflake/files/MarketPlace%2FCore%2Fviews%2Fshipments.view.lkml?line=2764",
                "permanent": null,
                "source_file": "MarketPlace/Core/views/shipments.view.lkml",
                "source_file_path": "snowflake/MarketPlace/Core/views/shipments.view.lkml",
                "sql": "${id} ",
                "sql_case": null,
                "filters": [
                    {
                        "field": "shipments.is_tonu",
                        "condition": "No"
                    }
                ],
                "times_used": 0
            }
        ],
        [
            {
                "key": "Saturday|FIELD|5",
                "data": {
                    "shipments.assigned_day_of_week": "Saturday"
                },
                "sort_values": {
                    "shipments.assigned_day_of_week": 5
                },
                "labels": {
                    "shipments.assigned_day_of_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>Saturday</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_day_of_week": {
                        "value": "Saturday",
                        "sort_value": 5
                    }
                }
            },
            {
                "label": "Percent of Shipments Count Shipments",
                "name": "percent_of_shipments_count_shipments_2",
                "expression": "(${shipments.shipment_count} / sum(${shipments.shipment_count}))",
                "can_pivot": true,
                "sortable": true,
                "type": "number",
                "align": "right",
                "measure": true,
                "is_table_calculation": true,
                "dynamic": true,
                "value_format": "#,##0%",
                "is_numeric": true
            }
        ],
        [
            {
                "key": "Sunday|FIELD|6",
                "data": {
                    "shipments.assigned_day_of_week": "Sunday"
                },
                "sort_values": {
                    "shipments.assigned_day_of_week": 6
                },
                "labels": {
                    "shipments.assigned_day_of_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>Sunday</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_day_of_week": {
                        "value": "Sunday",
                        "sort_value": 6
                    }
                }
            },
            {
                "align": "right",
                "can_filter": true,
                "category": "measure",
                "default_filter_value": null,
                "description": "Count Unique Shipment ID. Does not Include TONUs",
                "enumerations": null,
                "field_group_label": "Counts",
                "fill_style": null,
                "fiscal_month_offset": 0,
                "has_allowed_values": false,
                "hidden": false,
                "is_filter": false,
                "is_numeric": true,
                "label": "Shipments Count Shipments",
                "label_from_parameter": null,
                "label_short": "Count Shipments",
                "map_layer": null,
                "name": "shipments.shipment_count",
                "strict_value_format": false,
                "requires_refresh_on_sort": false,
                "sortable": true,
                "suggestions": null,
                "tags": [],
                "type": "count_distinct",
                "user_attribute_filter_types": [
                    "number",
                    "advanced_filter_number"
                ],
                "value_format": null,
                "view": "shipments",
                "view_label": "Shipments",
                "dynamic": false,
                "week_start_day": "monday",
                "original_view": "shipments",
                "dimension_group": null,
                "error": null,
                "field_group_variant": "Count Shipments",
                "measure": true,
                "parameter": false,
                "primary_key": false,
                "project_name": "snowflake",
                "scope": "shipments",
                "suggest_dimension": "shipments.shipment_count",
                "suggest_explore": "shipments",
                "suggestable": false,
                "is_fiscal": false,
                "is_timeframe": false,
                "can_time_filter": false,
                "time_interval": null,
                "lookml_link": "/projects/snowflake/files/MarketPlace%2FCore%2Fviews%2Fshipments.view.lkml?line=2764",
                "permanent": null,
                "source_file": "MarketPlace/Core/views/shipments.view.lkml",
                "source_file_path": "snowflake/MarketPlace/Core/views/shipments.view.lkml",
                "sql": "${id} ",
                "sql_case": null,
                "filters": [
                    {
                        "field": "shipments.is_tonu",
                        "condition": "No"
                    }
                ],
                "times_used": 0
            }
        ],
        [
            {
                "key": "Sunday|FIELD|6",
                "data": {
                    "shipments.assigned_day_of_week": "Sunday"
                },
                "sort_values": {
                    "shipments.assigned_day_of_week": 6
                },
                "labels": {
                    "shipments.assigned_day_of_week": "<a href='#drillmenu' class='cell-clickable-content' target='_self'>Sunday</a>"
                },
                "is_total": false,
                "metadata": {
                    "shipments.assigned_day_of_week": {
                        "value": "Sunday",
                        "sort_value": 6
                    }
                }
            },
            {
                "label": "Percent of Shipments Count Shipments",
                "name": "percent_of_shipments_count_shipments_2",
                "expression": "(${shipments.shipment_count} / sum(${shipments.shipment_count}))",
                "can_pivot": true,
                "sortable": true,
                "type": "number",
                "align": "right",
                "measure": true,
                "is_table_calculation": true,
                "dynamic": true,
                "value_format": "#,##0%",
                "is_numeric": true
            }
        ]
    ],
    "sorts": []
}, "data": [
    {
        "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
            "value": "T01 [10.0,10.01)",
            "filterable_value": "\"T01 [10.0,10.01)\"",
            "sort_value": "01"
        },
        "shipments.shipment_count": {
            "Monday|FIELD|0": {
                "value": 433,
                "links": [
                    {
                        "label": "Show All 433",
                        "label_prefix": "Show All",
                        "label_value": "433",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Monday&f[shipments.assigned_day_of_week_index]=0&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T01+%5B10.0%2C10.01%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Tuesday|FIELD|1": {
                "value": 432,
                "links": [
                    {
                        "label": "Show All 432",
                        "label_prefix": "Show All",
                        "label_value": "432",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Tuesday&f[shipments.assigned_day_of_week_index]=1&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T01+%5B10.0%2C10.01%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Wednesday|FIELD|2": {
                "value": 271,
                "links": [
                    {
                        "label": "Show All 271",
                        "label_prefix": "Show All",
                        "label_value": "271",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Wednesday&f[shipments.assigned_day_of_week_index]=2&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T01+%5B10.0%2C10.01%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Thursday|FIELD|3": {
                "value": 270,
                "links": [
                    {
                        "label": "Show All 270",
                        "label_prefix": "Show All",
                        "label_value": "270",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Thursday&f[shipments.assigned_day_of_week_index]=3&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T01+%5B10.0%2C10.01%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Friday|FIELD|4": {
                "value": 261,
                "links": [
                    {
                        "label": "Show All 261",
                        "label_prefix": "Show All",
                        "label_value": "261",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Friday&f[shipments.assigned_day_of_week_index]=4&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T01+%5B10.0%2C10.01%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Saturday|FIELD|5": {
                "value": 24,
                "links": [
                    {
                        "label": "Show All 24",
                        "label_prefix": "Show All",
                        "label_value": "24",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Saturday&f[shipments.assigned_day_of_week_index]=5&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T01+%5B10.0%2C10.01%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Sunday|FIELD|6": {
                "value": 21,
                "links": [
                    {
                        "label": "Show All 21",
                        "label_prefix": "Show All",
                        "label_value": "21",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Sunday&f[shipments.assigned_day_of_week_index]=6&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T01+%5B10.0%2C10.01%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            }
        },
        "percent_of_shipments_count_shipments_2": {
            "Monday|FIELD|0": {
                "value": 0.17013752455795678,
                "rendered": "17%"
            },
            "Tuesday|FIELD|1": {
                "value": 0.14819897084048028,
                "rendered": "15%"
            },
            "Wednesday|FIELD|2": {
                "value": 0.13376110562685095,
                "rendered": "13%"
            },
            "Thursday|FIELD|3": {
                "value": 0.1329394387001477,
                "rendered": "13%"
            },
            "Friday|FIELD|4": {
                "value": 0.14123376623376624,
                "rendered": "14%"
            },
            "Saturday|FIELD|5": {
                "value": 0.10572687224669604,
                "rendered": "11%"
            },
            "Sunday|FIELD|6": {
                "value": 0.11170212765957446,
                "rendered": "11%"
            }
        }
    },
    {
        "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
            "value": "T02 [10.01,20.0)",
            "filterable_value": "\"T02 [10.01,20.0)\"",
            "sort_value": "02"
        },
        "shipments.shipment_count": {
            "Monday|FIELD|0": {
                "value": 183,
                "links": [
                    {
                        "label": "Show All 183",
                        "label_prefix": "Show All",
                        "label_value": "183",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Monday&f[shipments.assigned_day_of_week_index]=0&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T02+%5B10.01%2C20.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Tuesday|FIELD|1": {
                "value": 202,
                "links": [
                    {
                        "label": "Show All 202",
                        "label_prefix": "Show All",
                        "label_value": "202",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Tuesday&f[shipments.assigned_day_of_week_index]=1&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T02+%5B10.01%2C20.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Wednesday|FIELD|2": {
                "value": 149,
                "links": [
                    {
                        "label": "Show All 149",
                        "label_prefix": "Show All",
                        "label_value": "149",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Wednesday&f[shipments.assigned_day_of_week_index]=2&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T02+%5B10.01%2C20.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Thursday|FIELD|3": {
                "value": 168,
                "links": [
                    {
                        "label": "Show All 168",
                        "label_prefix": "Show All",
                        "label_value": "168",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Thursday&f[shipments.assigned_day_of_week_index]=3&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T02+%5B10.01%2C20.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Friday|FIELD|4": {
                "value": 144,
                "links": [
                    {
                        "label": "Show All 144",
                        "label_prefix": "Show All",
                        "label_value": "144",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Friday&f[shipments.assigned_day_of_week_index]=4&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T02+%5B10.01%2C20.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Saturday|FIELD|5": {
                "value": 18,
                "links": [
                    {
                        "label": "Show All 18",
                        "label_prefix": "Show All",
                        "label_value": "18",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Saturday&f[shipments.assigned_day_of_week_index]=5&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T02+%5B10.01%2C20.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Sunday|FIELD|6": {
                "value": 15,
                "links": [
                    {
                        "label": "Show All 15",
                        "label_prefix": "Show All",
                        "label_value": "15",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Sunday&f[shipments.assigned_day_of_week_index]=6&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T02+%5B10.01%2C20.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            }
        },
        "percent_of_shipments_count_shipments_2": {
            "Monday|FIELD|0": {
                "value": 0.0719056974459725,
                "rendered": "7%"
            },
            "Tuesday|FIELD|1": {
                "value": 0.06929674099485421,
                "rendered": "7%"
            },
            "Wednesday|FIELD|2": {
                "value": 0.07354392892398816,
                "rendered": "7%"
            },
            "Thursday|FIELD|3": {
                "value": 0.0827178729689808,
                "rendered": "8%"
            },
            "Friday|FIELD|4": {
                "value": 0.07792207792207792,
                "rendered": "8%"
            },
            "Saturday|FIELD|5": {
                "value": 0.07929515418502203,
                "rendered": "8%"
            },
            "Sunday|FIELD|6": {
                "value": 0.0797872340425532,
                "rendered": "8%"
            }
        }
    },
    {
        "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
            "value": "T03 [20.0,30.0)",
            "filterable_value": "\"T03 [20.0,30.0)\"",
            "sort_value": "03"
        },
        "shipments.shipment_count": {
            "Monday|FIELD|0": {
                "value": 327,
                "links": [
                    {
                        "label": "Show All 327",
                        "label_prefix": "Show All",
                        "label_value": "327",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Monday&f[shipments.assigned_day_of_week_index]=0&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T03+%5B20.0%2C30.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Tuesday|FIELD|1": {
                "value": 386,
                "links": [
                    {
                        "label": "Show All 386",
                        "label_prefix": "Show All",
                        "label_value": "386",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Tuesday&f[shipments.assigned_day_of_week_index]=1&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T03+%5B20.0%2C30.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Wednesday|FIELD|2": {
                "value": 277,
                "links": [
                    {
                        "label": "Show All 277",
                        "label_prefix": "Show All",
                        "label_value": "277",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Wednesday&f[shipments.assigned_day_of_week_index]=2&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T03+%5B20.0%2C30.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Thursday|FIELD|3": {
                "value": 291,
                "links": [
                    {
                        "label": "Show All 291",
                        "label_prefix": "Show All",
                        "label_value": "291",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Thursday&f[shipments.assigned_day_of_week_index]=3&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T03+%5B20.0%2C30.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Friday|FIELD|4": {
                "value": 200,
                "links": [
                    {
                        "label": "Show All 200",
                        "label_prefix": "Show All",
                        "label_value": "200",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Friday&f[shipments.assigned_day_of_week_index]=4&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T03+%5B20.0%2C30.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Saturday|FIELD|5": {
                "value": 27,
                "links": [
                    {
                        "label": "Show All 27",
                        "label_prefix": "Show All",
                        "label_value": "27",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Saturday&f[shipments.assigned_day_of_week_index]=5&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T03+%5B20.0%2C30.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Sunday|FIELD|6": {
                "value": 28,
                "links": [
                    {
                        "label": "Show All 28",
                        "label_prefix": "Show All",
                        "label_value": "28",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Sunday&f[shipments.assigned_day_of_week_index]=6&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T03+%5B20.0%2C30.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            }
        },
        "percent_of_shipments_count_shipments_2": {
            "Monday|FIELD|0": {
                "value": 0.12848722986247543,
                "rendered": "13%"
            },
            "Tuesday|FIELD|1": {
                "value": 0.13241852487135505,
                "rendered": "13%"
            },
            "Wednesday|FIELD|2": {
                "value": 0.13672260612043435,
                "rendered": "14%"
            },
            "Thursday|FIELD|3": {
                "value": 0.1432791728212703,
                "rendered": "14%"
            },
            "Friday|FIELD|4": {
                "value": 0.10822510822510822,
                "rendered": "11%"
            },
            "Saturday|FIELD|5": {
                "value": 0.11894273127753303,
                "rendered": "12%"
            },
            "Sunday|FIELD|6": {
                "value": 0.14893617021276595,
                "rendered": "15%"
            }
        }
    },
    {
        "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
            "value": "T04 [30.0,40.0)",
            "filterable_value": "\"T04 [30.0,40.0)\"",
            "sort_value": "04"
        },
        "shipments.shipment_count": {
            "Monday|FIELD|0": {
                "value": 192,
                "links": [
                    {
                        "label": "Show All 192",
                        "label_prefix": "Show All",
                        "label_value": "192",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Monday&f[shipments.assigned_day_of_week_index]=0&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T04+%5B30.0%2C40.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Tuesday|FIELD|1": {
                "value": 245,
                "links": [
                    {
                        "label": "Show All 245",
                        "label_prefix": "Show All",
                        "label_value": "245",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Tuesday&f[shipments.assigned_day_of_week_index]=1&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T04+%5B30.0%2C40.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Wednesday|FIELD|2": {
                "value": 129,
                "links": [
                    {
                        "label": "Show All 129",
                        "label_prefix": "Show All",
                        "label_value": "129",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Wednesday&f[shipments.assigned_day_of_week_index]=2&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T04+%5B30.0%2C40.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Thursday|FIELD|3": {
                "value": 111,
                "links": [
                    {
                        "label": "Show All 111",
                        "label_prefix": "Show All",
                        "label_value": "111",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Thursday&f[shipments.assigned_day_of_week_index]=3&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T04+%5B30.0%2C40.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Friday|FIELD|4": {
                "value": 125,
                "links": [
                    {
                        "label": "Show All 125",
                        "label_prefix": "Show All",
                        "label_value": "125",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Friday&f[shipments.assigned_day_of_week_index]=4&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T04+%5B30.0%2C40.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Saturday|FIELD|5": {
                "value": 17,
                "links": [
                    {
                        "label": "Show All 17",
                        "label_prefix": "Show All",
                        "label_value": "17",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Saturday&f[shipments.assigned_day_of_week_index]=5&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T04+%5B30.0%2C40.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Sunday|FIELD|6": {
                "value": 14,
                "links": [
                    {
                        "label": "Show All 14",
                        "label_prefix": "Show All",
                        "label_value": "14",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Sunday&f[shipments.assigned_day_of_week_index]=6&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T04+%5B30.0%2C40.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            }
        },
        "percent_of_shipments_count_shipments_2": {
            "Monday|FIELD|0": {
                "value": 0.07544204322200393,
                "rendered": "8%"
            },
            "Tuesday|FIELD|1": {
                "value": 0.08404802744425385,
                "rendered": "8%"
            },
            "Wednesday|FIELD|2": {
                "value": 0.06367226061204344,
                "rendered": "6%"
            },
            "Thursday|FIELD|3": {
                "value": 0.05465288035450517,
                "rendered": "5%"
            },
            "Friday|FIELD|4": {
                "value": 0.06764069264069264,
                "rendered": "7%"
            },
            "Saturday|FIELD|5": {
                "value": 0.07488986784140969,
                "rendered": "7%"
            },
            "Sunday|FIELD|6": {
                "value": 0.07446808510638298,
                "rendered": "7%"
            }
        }
    },
    {
        "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
            "value": "T05 [40.0,50.0)",
            "filterable_value": "\"T05 [40.0,50.0)\"",
            "sort_value": "05"
        },
        "shipments.shipment_count": {
            "Monday|FIELD|0": {
                "value": 155,
                "links": [
                    {
                        "label": "Show All 155",
                        "label_prefix": "Show All",
                        "label_value": "155",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Monday&f[shipments.assigned_day_of_week_index]=0&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T05+%5B40.0%2C50.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Tuesday|FIELD|1": {
                "value": 196,
                "links": [
                    {
                        "label": "Show All 196",
                        "label_prefix": "Show All",
                        "label_value": "196",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Tuesday&f[shipments.assigned_day_of_week_index]=1&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T05+%5B40.0%2C50.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Wednesday|FIELD|2": {
                "value": 110,
                "links": [
                    {
                        "label": "Show All 110",
                        "label_prefix": "Show All",
                        "label_value": "110",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Wednesday&f[shipments.assigned_day_of_week_index]=2&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T05+%5B40.0%2C50.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Thursday|FIELD|3": {
                "value": 140,
                "links": [
                    {
                        "label": "Show All 140",
                        "label_prefix": "Show All",
                        "label_value": "140",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Thursday&f[shipments.assigned_day_of_week_index]=3&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T05+%5B40.0%2C50.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Friday|FIELD|4": {
                "value": 107,
                "links": [
                    {
                        "label": "Show All 107",
                        "label_prefix": "Show All",
                        "label_value": "107",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Friday&f[shipments.assigned_day_of_week_index]=4&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T05+%5B40.0%2C50.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Saturday|FIELD|5": {
                "value": 6,
                "links": [
                    {
                        "label": "Show All 6",
                        "label_prefix": "Show All",
                        "label_value": "6",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Saturday&f[shipments.assigned_day_of_week_index]=5&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T05+%5B40.0%2C50.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Sunday|FIELD|6": {
                "value": 5,
                "links": [
                    {
                        "label": "Show All 5",
                        "label_prefix": "Show All",
                        "label_value": "5",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Sunday&f[shipments.assigned_day_of_week_index]=6&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T05+%5B40.0%2C50.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            }
        },
        "percent_of_shipments_count_shipments_2": {
            "Monday|FIELD|0": {
                "value": 0.060903732809430254,
                "rendered": "6%"
            },
            "Tuesday|FIELD|1": {
                "value": 0.06723842195540308,
                "rendered": "7%"
            },
            "Wednesday|FIELD|2": {
                "value": 0.054294175715695954,
                "rendered": "5%"
            },
            "Thursday|FIELD|3": {
                "value": 0.068931560807484,
                "rendered": "7%"
            },
            "Friday|FIELD|4": {
                "value": 0.057900432900432904,
                "rendered": "6%"
            },
            "Saturday|FIELD|5": {
                "value": 0.02643171806167401,
                "rendered": "3%"
            },
            "Sunday|FIELD|6": {
                "value": 0.026595744680851064,
                "rendered": "3%"
            }
        }
    },
    {
        "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
            "value": "T06 [50.0,60.0)",
            "filterable_value": "\"T06 [50.0,60.0)\"",
            "sort_value": "06"
        },
        "shipments.shipment_count": {
            "Monday|FIELD|0": {
                "value": 214,
                "links": [
                    {
                        "label": "Show All 214",
                        "label_prefix": "Show All",
                        "label_value": "214",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Monday&f[shipments.assigned_day_of_week_index]=0&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T06+%5B50.0%2C60.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Tuesday|FIELD|1": {
                "value": 236,
                "links": [
                    {
                        "label": "Show All 236",
                        "label_prefix": "Show All",
                        "label_value": "236",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Tuesday&f[shipments.assigned_day_of_week_index]=1&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T06+%5B50.0%2C60.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Wednesday|FIELD|2": {
                "value": 169,
                "links": [
                    {
                        "label": "Show All 169",
                        "label_prefix": "Show All",
                        "label_value": "169",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Wednesday&f[shipments.assigned_day_of_week_index]=2&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T06+%5B50.0%2C60.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Thursday|FIELD|3": {
                "value": 167,
                "links": [
                    {
                        "label": "Show All 167",
                        "label_prefix": "Show All",
                        "label_value": "167",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Thursday&f[shipments.assigned_day_of_week_index]=3&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T06+%5B50.0%2C60.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Friday|FIELD|4": {
                "value": 137,
                "links": [
                    {
                        "label": "Show All 137",
                        "label_prefix": "Show All",
                        "label_value": "137",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Friday&f[shipments.assigned_day_of_week_index]=4&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T06+%5B50.0%2C60.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Saturday|FIELD|5": {
                "value": 17,
                "links": [
                    {
                        "label": "Show All 17",
                        "label_prefix": "Show All",
                        "label_value": "17",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Saturday&f[shipments.assigned_day_of_week_index]=5&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T06+%5B50.0%2C60.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Sunday|FIELD|6": {
                "value": 22,
                "links": [
                    {
                        "label": "Show All 22",
                        "label_prefix": "Show All",
                        "label_value": "22",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Sunday&f[shipments.assigned_day_of_week_index]=6&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T06+%5B50.0%2C60.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            }
        },
        "percent_of_shipments_count_shipments_2": {
            "Monday|FIELD|0": {
                "value": 0.08408644400785854,
                "rendered": "8%"
            },
            "Tuesday|FIELD|1": {
                "value": 0.08096054888507719,
                "rendered": "8%"
            },
            "Wednesday|FIELD|2": {
                "value": 0.08341559723593288,
                "rendered": "8%"
            },
            "Thursday|FIELD|3": {
                "value": 0.08222550467749877,
                "rendered": "8%"
            },
            "Friday|FIELD|4": {
                "value": 0.07413419913419914,
                "rendered": "7%"
            },
            "Saturday|FIELD|5": {
                "value": 0.07488986784140969,
                "rendered": "7%"
            },
            "Sunday|FIELD|6": {
                "value": 0.11702127659574468,
                "rendered": "12%"
            }
        }
    },
    {
        "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
            "value": "T07 [60.0,70.0)",
            "filterable_value": "\"T07 [60.0,70.0)\"",
            "sort_value": "07"
        },
        "shipments.shipment_count": {
            "Monday|FIELD|0": {
                "value": 195,
                "links": [
                    {
                        "label": "Show All 195",
                        "label_prefix": "Show All",
                        "label_value": "195",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Monday&f[shipments.assigned_day_of_week_index]=0&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T07+%5B60.0%2C70.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Tuesday|FIELD|1": {
                "value": 207,
                "links": [
                    {
                        "label": "Show All 207",
                        "label_prefix": "Show All",
                        "label_value": "207",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Tuesday&f[shipments.assigned_day_of_week_index]=1&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T07+%5B60.0%2C70.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Wednesday|FIELD|2": {
                "value": 142,
                "links": [
                    {
                        "label": "Show All 142",
                        "label_prefix": "Show All",
                        "label_value": "142",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Wednesday&f[shipments.assigned_day_of_week_index]=2&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T07+%5B60.0%2C70.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Thursday|FIELD|3": {
                "value": 132,
                "links": [
                    {
                        "label": "Show All 132",
                        "label_prefix": "Show All",
                        "label_value": "132",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Thursday&f[shipments.assigned_day_of_week_index]=3&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T07+%5B60.0%2C70.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Friday|FIELD|4": {
                "value": 154,
                "links": [
                    {
                        "label": "Show All 154",
                        "label_prefix": "Show All",
                        "label_value": "154",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Friday&f[shipments.assigned_day_of_week_index]=4&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T07+%5B60.0%2C70.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Saturday|FIELD|5": {
                "value": 23,
                "links": [
                    {
                        "label": "Show All 23",
                        "label_prefix": "Show All",
                        "label_value": "23",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Saturday&f[shipments.assigned_day_of_week_index]=5&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T07+%5B60.0%2C70.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Sunday|FIELD|6": {
                "value": 12,
                "links": [
                    {
                        "label": "Show All 12",
                        "label_prefix": "Show All",
                        "label_value": "12",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Sunday&f[shipments.assigned_day_of_week_index]=6&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T07+%5B60.0%2C70.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            }
        },
        "percent_of_shipments_count_shipments_2": {
            "Monday|FIELD|0": {
                "value": 0.07662082514734773,
                "rendered": "8%"
            },
            "Tuesday|FIELD|1": {
                "value": 0.07101200686106346,
                "rendered": "7%"
            },
            "Wednesday|FIELD|2": {
                "value": 0.0700888450148075,
                "rendered": "7%"
            },
            "Thursday|FIELD|3": {
                "value": 0.06499261447562776,
                "rendered": "6%"
            },
            "Friday|FIELD|4": {
                "value": 0.08333333333333333,
                "rendered": "8%"
            },
            "Saturday|FIELD|5": {
                "value": 0.1013215859030837,
                "rendered": "10%"
            },
            "Sunday|FIELD|6": {
                "value": 0.06382978723404255,
                "rendered": "6%"
            }
        }
    },
    {
        "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
            "value": "T08 [70.0,80.0)",
            "filterable_value": "\"T08 [70.0,80.0)\"",
            "sort_value": "08"
        },
        "shipments.shipment_count": {
            "Monday|FIELD|0": {
                "value": 229,
                "links": [
                    {
                        "label": "Show All 229",
                        "label_prefix": "Show All",
                        "label_value": "229",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Monday&f[shipments.assigned_day_of_week_index]=0&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T08+%5B70.0%2C80.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Tuesday|FIELD|1": {
                "value": 315,
                "links": [
                    {
                        "label": "Show All 315",
                        "label_prefix": "Show All",
                        "label_value": "315",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Tuesday&f[shipments.assigned_day_of_week_index]=1&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T08+%5B70.0%2C80.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Wednesday|FIELD|2": {
                "value": 202,
                "links": [
                    {
                        "label": "Show All 202",
                        "label_prefix": "Show All",
                        "label_value": "202",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Wednesday&f[shipments.assigned_day_of_week_index]=2&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T08+%5B70.0%2C80.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Thursday|FIELD|3": {
                "value": 239,
                "links": [
                    {
                        "label": "Show All 239",
                        "label_prefix": "Show All",
                        "label_value": "239",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Thursday&f[shipments.assigned_day_of_week_index]=3&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T08+%5B70.0%2C80.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Friday|FIELD|4": {
                "value": 188,
                "links": [
                    {
                        "label": "Show All 188",
                        "label_prefix": "Show All",
                        "label_value": "188",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Friday&f[shipments.assigned_day_of_week_index]=4&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T08+%5B70.0%2C80.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Saturday|FIELD|5": {
                "value": 30,
                "links": [
                    {
                        "label": "Show All 30",
                        "label_prefix": "Show All",
                        "label_value": "30",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Saturday&f[shipments.assigned_day_of_week_index]=5&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T08+%5B70.0%2C80.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Sunday|FIELD|6": {
                "value": 12,
                "links": [
                    {
                        "label": "Show All 12",
                        "label_prefix": "Show All",
                        "label_value": "12",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Sunday&f[shipments.assigned_day_of_week_index]=6&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T08+%5B70.0%2C80.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            }
        },
        "percent_of_shipments_count_shipments_2": {
            "Monday|FIELD|0": {
                "value": 0.0899803536345776,
                "rendered": "9%"
            },
            "Tuesday|FIELD|1": {
                "value": 0.10806174957118353,
                "rendered": "11%"
            },
            "Wednesday|FIELD|2": {
                "value": 0.09970384995064166,
                "rendered": "10%"
            },
            "Thursday|FIELD|3": {
                "value": 0.11767602166420482,
                "rendered": "12%"
            },
            "Friday|FIELD|4": {
                "value": 0.10173160173160173,
                "rendered": "10%"
            },
            "Saturday|FIELD|5": {
                "value": 0.13215859030837004,
                "rendered": "13%"
            },
            "Sunday|FIELD|6": {
                "value": 0.06382978723404255,
                "rendered": "6%"
            }
        }
    },
    {
        "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
            "value": "T09 [80.0,90.0)",
            "filterable_value": "\"T09 [80.0,90.0)\"",
            "sort_value": "09"
        },
        "shipments.shipment_count": {
            "Monday|FIELD|0": {
                "value": 242,
                "links": [
                    {
                        "label": "Show All 242",
                        "label_prefix": "Show All",
                        "label_value": "242",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Monday&f[shipments.assigned_day_of_week_index]=0&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T09+%5B80.0%2C90.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Tuesday|FIELD|1": {
                "value": 223,
                "links": [
                    {
                        "label": "Show All 223",
                        "label_prefix": "Show All",
                        "label_value": "223",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Tuesday&f[shipments.assigned_day_of_week_index]=1&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T09+%5B80.0%2C90.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Wednesday|FIELD|2": {
                "value": 174,
                "links": [
                    {
                        "label": "Show All 174",
                        "label_prefix": "Show All",
                        "label_value": "174",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Wednesday&f[shipments.assigned_day_of_week_index]=2&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T09+%5B80.0%2C90.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Thursday|FIELD|3": {
                "value": 178,
                "links": [
                    {
                        "label": "Show All 178",
                        "label_prefix": "Show All",
                        "label_value": "178",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Thursday&f[shipments.assigned_day_of_week_index]=3&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T09+%5B80.0%2C90.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Friday|FIELD|4": {
                "value": 190,
                "links": [
                    {
                        "label": "Show All 190",
                        "label_prefix": "Show All",
                        "label_value": "190",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Friday&f[shipments.assigned_day_of_week_index]=4&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T09+%5B80.0%2C90.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Saturday|FIELD|5": {
                "value": 22,
                "links": [
                    {
                        "label": "Show All 22",
                        "label_prefix": "Show All",
                        "label_value": "22",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Saturday&f[shipments.assigned_day_of_week_index]=5&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T09+%5B80.0%2C90.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Sunday|FIELD|6": {
                "value": 17,
                "links": [
                    {
                        "label": "Show All 17",
                        "label_prefix": "Show All",
                        "label_value": "17",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Sunday&f[shipments.assigned_day_of_week_index]=6&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T09+%5B80.0%2C90.0%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            }
        },
        "percent_of_shipments_count_shipments_2": {
            "Monday|FIELD|0": {
                "value": 0.09508840864440078,
                "rendered": "10%"
            },
            "Tuesday|FIELD|1": {
                "value": 0.0765008576329331,
                "rendered": "8%"
            },
            "Wednesday|FIELD|2": {
                "value": 0.08588351431391905,
                "rendered": "9%"
            },
            "Thursday|FIELD|3": {
                "value": 0.08764155588380108,
                "rendered": "9%"
            },
            "Friday|FIELD|4": {
                "value": 0.10281385281385282,
                "rendered": "10%"
            },
            "Saturday|FIELD|5": {
                "value": 0.09691629955947137,
                "rendered": "10%"
            },
            "Sunday|FIELD|6": {
                "value": 0.09042553191489362,
                "rendered": "9%"
            }
        }
    },
    {
        "shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier": {
            "value": "T10 [90.0,inf)",
            "filterable_value": "\"T10 [90.0,inf)\"",
            "sort_value": "10"
        },
        "shipments.shipment_count": {
            "Monday|FIELD|0": {
                "value": 375,
                "links": [
                    {
                        "label": "Show All 375",
                        "label_prefix": "Show All",
                        "label_value": "375",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Monday&f[shipments.assigned_day_of_week_index]=0&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T10+%5B90.0%2Cinf%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Tuesday|FIELD|1": {
                "value": 473,
                "links": [
                    {
                        "label": "Show All 473",
                        "label_prefix": "Show All",
                        "label_value": "473",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Tuesday&f[shipments.assigned_day_of_week_index]=1&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T10+%5B90.0%2Cinf%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Wednesday|FIELD|2": {
                "value": 403,
                "links": [
                    {
                        "label": "Show All 403",
                        "label_prefix": "Show All",
                        "label_value": "403",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Wednesday&f[shipments.assigned_day_of_week_index]=2&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T10+%5B90.0%2Cinf%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Thursday|FIELD|3": {
                "value": 335,
                "links": [
                    {
                        "label": "Show All 335",
                        "label_prefix": "Show All",
                        "label_value": "335",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Thursday&f[shipments.assigned_day_of_week_index]=3&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T10+%5B90.0%2Cinf%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Friday|FIELD|4": {
                "value": 342,
                "links": [
                    {
                        "label": "Show All 342",
                        "label_prefix": "Show All",
                        "label_value": "342",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Friday&f[shipments.assigned_day_of_week_index]=4&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T10+%5B90.0%2Cinf%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Saturday|FIELD|5": {
                "value": 43,
                "links": [
                    {
                        "label": "Show All 43",
                        "label_prefix": "Show All",
                        "label_value": "43",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Saturday&f[shipments.assigned_day_of_week_index]=5&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T10+%5B90.0%2Cinf%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            },
            "Sunday|FIELD|6": {
                "value": 42,
                "links": [
                    {
                        "label": "Show All 42",
                        "label_prefix": "Show All",
                        "label_value": "42",
                        "url": "/explore/snowflake_marketplace/shipments?fields=shipments.id,shipments.state,shipments.created_date,shipments.assigned_date,equipment.parent_name,shipments.lane_city_state,carrier_manager_parent.name,driver_parent.name,driver_parent.phone,shipment_tracking_pings.is_tracking,first_pickup_appointment.appointment_end_local_time,first_pickup.late_reason,last_delivery_appointment.appointment_end_local_time,last_delivery.late_reason,shipments.shipper_total_rate,shipments.carrier_total_rate,shipments.total_margin,shipments.dat_rate,shipments.carrier_manager_target&f[shipments.assigned_week]=4+weeks&f[shipments.assigned_day_of_week]=Sunday&f[shipments.assigned_day_of_week_index]=6&f[shipments.include_in_company_margin]=Yes&f[shipment_transfix_cost_predictions.carrier_rate_as_tcm_percentile_tier]=%22T10+%5B90.0%2Cinf%29%22&f[shipments.is_tonu]=No&query_timezone=America%2FNew_York&limit=500",
                        "type": "measure_default"
                    }
                ]
            }
        },
        "percent_of_shipments_count_shipments_2": {
            "Monday|FIELD|0": {
                "value": 0.14734774066797643,
                "rendered": "15%"
            },
            "Tuesday|FIELD|1": {
                "value": 0.16226415094339622,
                "rendered": "16%"
            },
            "Wednesday|FIELD|2": {
                "value": 0.19891411648568608,
                "rendered": "20%"
            },
            "Thursday|FIELD|3": {
                "value": 0.16494337764647957,
                "rendered": "16%"
            },
            "Friday|FIELD|4": {
                "value": 0.18506493506493507,
                "rendered": "19%"
            },
            "Saturday|FIELD|5": {
                "value": 0.1894273127753304,
                "rendered": "19%"
            },
            "Sunday|FIELD|6": {
                "value": 0.22340425531914893,
                "rendered": "22%"
            }
        }
    }
]}